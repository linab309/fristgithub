###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.51A/W32 for 8051                29/Sep/2011  15:47:18 #
# Copyright 2004-2009 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Com #
#                          ponents\hal\target\CC2530EB\hal_lcd.c              #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0 #
#                          \Projects\zstack\Samples\LightCtlPrj\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wEndev.cfg" (-DCPU32MHZ      #
#                          -DROOT=__near_func -DBLINK_LEDS) -f "C:\Texas      #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wConfig.cfg" (-DSECURE=0                  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00001000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x1212                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Co #
#                          mponents\hal\target\CC2530EB\hal_lcd.c" -D         #
#                          NWK_AUTO_POLL -D ZTOOL_P1 -D MT_TASK -D            #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG  #
#                          -D HAL_UART=TRUE -D xPOWER_SAVING -lC "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\EndDeviceEB\List\ #
#                          " -lA "C:\Texas Instruments\ZStack-CC2530-2.2.2-1. #
#                          3.0\Projects\zstack\Samples\LightCtlPrj\CC2530DB\E #
#                          ndDeviceEB\List\" --diag_suppress Pe001,Pa010 -o   #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\LightCtlPrj\CC2530DB\EndDevi #
#                          ceEB\Obj\" -e --require_prototypes --debug         #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 8 -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\" -I "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\SOURCE\" -I    #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\LightCtlPrj\CC2530DB\..\..\. #
#                          .\ZMAIN\TI2530DB\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MT\" -I "C:\Texas                         #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\TARGET\CC2530EB\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\INCLUDE\" -I "C:\Texas               #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\AF\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\NWK\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SEC\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SAPI\" -I "C:\Texas                 #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SYS\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\ZDO\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\F8W\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\" -I "C:\Texas                       #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SADDR\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SDATA\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\LightCtlPrj\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\" -I      #
#                          "C:\Program Files\IAR Systems\Embedded Workbench   #
#                          5.3\8051\INC\" -I "C:\Program Files\IAR            #
#                          Systems\Embedded Workbench 5.3\8051\INC\CLIB\"     #
#                          -Ohz                                               #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\LightCtlPrj\CC2530DB\EndDevic #
#                          eEB\List\hal_lcd.lst                               #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\LightCtlPrj\CC2530DB\EndDevic #
#                          eEB\Obj\hal_lcd.r51                                #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Components\hal\target\CC2530EB\hal_lcd.c
      1          /**************************************************************************************************
      2            Filename:       hal_lcd.c
      3            Revised:        $Date: 2007-11-01 08:44:53 -0700 (Thu, 01 Nov 2007) $
      4            Revision:       $Revision: 15821 $
      5          
      6            Description:    This file contains the interface to the HAL LCD Service.
      7          
      8          
      9            Copyright 2006-2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com. 
     38          **************************************************************************************************/
     39          
     40          /**************************************************************************************************
     41           *                                           INCLUDES
     42           **************************************************************************************************/
     43          #include "hal_types.h"
     44          #include "hal_lcd.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf3
   \   unsigned char volatile __sfr P0SEL
   \                     P0SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     45          #include "OSAL.h"
     46          #include "OnBoard.h"
     47          
     48          #ifdef ZTOOL_PORT
     49            #include "DebugTrace.h"
     50          #endif
     51          
     52          /**************************************************************************************************
     53           *                                          CONSTANTS
     54           **************************************************************************************************/
     55          #define LCD_MAX_BUF 25
     56          
     57          // LCD port/bit definitions   jwz修改引脚的定义
     58          #define LCD_DC                 P0_0
     59          #define LCD_SDA                P1_6
     60          #define LCD_SCL                P1_5
     61          #define LCD_CE                 P1_2
     62          
     63          /**************************************/
     64          //english_6x8_pixel
     65          // 6 x 8 font
     66          // 1 pixel space at left and bottom
     67          // index = ASCII - 32

   \                                 In  segment CODE_C, align 1
     68          __code const unsigned char font6x8[][6] =
   \                     font6x8:
   \   000000   00000000     DB 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 7, 0, 7, 0, 0, 20, 127
   \            00000000
   \            002F0000
   \            00000700
   \            07000014
   \            7F      
   \   000015   147F1400     DB 20, 127, 20, 0, 36, 42, 127, 42, 18, 0, 98, 100, 8, 19, 35, 0, 54
   \            242A7F2A
   \            12006264
   \            08132300
   \            36      
   \   000026   49552250     DB 73, 85, 34, 80, 0, 0, 5, 3, 0, 0, 0, 0, 28, 34, 65, 0, 0, 0, 65, 34
   \            00000503
   \            00000000
   \            1C224100
   \            00004122
   \   00003A   1C000014     DB 28, 0, 0, 20, 8, 62, 8, 20, 0, 8, 8, 62, 8, 8, 0, 0, 0, 160, 96, 0
   \            083E0814
   \            0008083E
   \            08080000
   \            00A06000
   \   00004E   00080808     DB 0, 8, 8, 8, 8, 8, 0, 0, 96, 96, 0, 0, 0, 32, 16, 8, 4, 2, 0, 62, 81
   \            08080000
   \            60600000
   \            00201008
   \            0402003E
   \            51      
   \   000063   49453E00     DB 73, 69, 62, 0, 0, 66, 127, 64, 0, 0, 66, 97, 81, 73, 70, 0, 33, 65
   \            00427F40
   \            00004261
   \            51494600
   \            2141    
   \   000075   454B3100     DB 69, 75, 49, 0, 24, 20, 18, 127, 16, 0, 39, 69, 69, 69, 57, 0, 60, 74
   \            1814127F
   \            10002745
   \            45453900
   \            3C4A    
   \   000087   49493000     DB 73, 73, 48, 0, 1, 113, 9, 5, 3, 0, 54, 73, 73, 73, 54, 0, 6, 73, 73
   \            01710905
   \            03003649
   \            49493600
   \            064949  
   \   00009A   291E0000     DB 41, 30, 0, 0, 54, 54, 0, 0, 0, 0, 86, 54, 0, 0, 0, 8, 20, 34, 65, 0
   \            36360000
   \            00005636
   \            00000008
   \            14224100
   \   0000AE   00141414     DB 0, 20, 20, 20, 20, 20, 0, 0, 65, 34, 20, 8, 0, 2, 1, 81, 9, 6, 0, 50
   \            14140000
   \            41221408
   \            00020151
   \            09060032
   \   0000C2   4959513E     DB 73, 89, 81, 62, 0, 124, 18, 17, 18, 124, 0, 127, 73, 73, 73, 54, 0
   \            007C1211
   \            127C007F
   \            49494936
   \            00      
   \   0000D3   3E414141     DB 62, 65, 65, 65, 34, 0, 127, 65, 65, 34, 28, 0, 127, 73, 73, 73, 65
   \            22007F41
   \            41221C00
   \            7F494949
   \            41      
   \   0000E4   007F0909     DB 0, 127, 9, 9, 9, 1, 0, 62, 65, 73, 73, 122, 0, 127, 8, 8, 8, 127, 0
   \            0901003E
   \            4149497A
   \            007F0808
   \            087F00  
   \   0000F7   00417F41     DB 0, 65, 127, 65, 0, 0, 32, 64, 65, 63, 1, 0, 127, 8, 20, 34, 65, 0
   \            00002040
   \            413F0100
   \            7F081422
   \            4100    
   \   000109   7F404040     DB 127, 64, 64, 64, 64, 0, 127, 2, 12, 2, 127, 0, 127, 4, 8, 16, 127, 0
   \            40007F02
   \            0C027F00
   \            7F040810
   \            7F00    
   \   00011B   3E414141     DB 62, 65, 65, 65, 62, 0, 127, 9, 9, 9, 6, 0, 62, 65, 81, 33, 94, 0
   \            3E007F09
   \            09090600
   \            3E415121
   \            5E00    
   \   00012D   7F091929     DB 127, 9, 25, 41, 70, 0, 70, 73, 73, 73, 49, 0, 1, 1, 127, 1, 1, 0, 63
   \            46004649
   \            49493100
   \            01017F01
   \            01003F  
   \   000140   4040403F     DB 64, 64, 64, 63, 0, 31, 32, 64, 32, 31, 0, 63, 64, 56, 64, 63, 0, 99
   \            001F2040
   \            201F003F
   \            4038403F
   \            0063    
   \   000152   14081463     DB 20, 8, 20, 99, 0, 7, 8, 112, 8, 7, 0, 97, 81, 73, 69, 67, 0, 0, 127
   \            00070870
   \            08070061
   \            51494543
   \            00007F  
   \   000165   41410000     DB 65, 65, 0, 0, 85, 42, 85, 42, 85, 0, 0, 65, 65, 127, 0, 0, 4, 2, 1
   \            552A552A
   \            55000041
   \            417F0000
   \            040201  
   \   000178   02040040     DB 2, 4, 0, 64, 64, 64, 64, 64, 0, 0, 1, 2, 4, 0, 0, 32, 84, 84, 84
   \            40404040
   \            00000102
   \            04000020
   \            545454  
   \   00018B   78007F48     DB 120, 0, 127, 72, 68, 68, 56, 0, 56, 68, 68, 68, 32, 0, 56, 68, 68
   \            44443800
   \            38444444
   \            20003844
   \            44      
   \   00019C   487F0038     DB 72, 127, 0, 56, 84, 84, 84, 24, 0, 8, 126, 9, 1, 2, 0, 24, 164, 164
   \            54545418
   \            00087E09
   \            01020018
   \            A4A4    
   \   0001AE   A47C007F     DB 164, 124, 0, 127, 8, 4, 4, 120, 0, 0, 68, 125, 64, 0, 0, 64, 128
   \            08040478
   \            0000447D
   \            40000040
   \            80      
   \   0001BF   847D0000     DB 132, 125, 0, 0, 127, 16, 40, 68, 0, 0, 0, 65, 127, 64, 0, 0, 124, 4
   \            7F102844
   \            00000041
   \            7F400000
   \            7C04    
   \   0001D1   18047800     DB 24, 4, 120, 0, 124, 8, 4, 4, 120, 0, 56, 68, 68, 68, 56, 0, 252, 36
   \            7C080404
   \            78003844
   \            44443800
   \            FC24    
   \   0001E3   24241800     DB 36, 36, 24, 0, 24, 36, 36, 24, 252, 0, 124, 8, 4, 4, 8, 0, 72, 84
   \            18242418
   \            FC007C08
   \            04040800
   \            4854    
   \   0001F5   54542000     DB 84, 84, 32, 0, 4, 63, 68, 64, 32, 0, 60, 64, 64, 32, 124, 0, 28, 32
   \            043F4440
   \            20003C40
   \            40207C00
   \            1C20    
   \   000207   40201C00     DB 64, 32, 28, 0, 60, 64, 48, 64, 60, 0, 68, 40, 16, 40, 68, 0, 28, 160
   \            3C403040
   \            3C004428
   \            10284400
   \            1CA0    
   \   000219   A0A07C00     DB 160, 160, 124, 0, 68, 100, 84, 76, 68, 0, 0, 255, 255, 0, 0, 8, 28
   \            4464544C
   \            440000FF
   \            FF000008
   \            1C      
   \   00022A   2A080808     DB 42, 8, 8, 8, 8, 8, 8, 42, 28, 8, 4, 2, 255, 2, 4, 0, 0, 32, 64, 255
   \            0808082A
   \            1C080402
   \            FF020400
   \            002040FF
   \   00023E   4020         DB 64, 32
     69          {
     70            { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp  0
     71            { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !   1
     72            { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "   2
     73            { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #   3
     74            { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $   4
     75            { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %   5
     76            { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &   6
     77            { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '   7
     78            { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (   8
     79            { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )   9
     80            { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *   10
     81            { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +   11
     82            { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,   12
     83            { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -   13
     84            { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .   14
     85            { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /   15
     86            { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0   16
     87            { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1   17
     88            { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2   18
     89            { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3   19
     90            { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4   20
     91            { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5   21
     92            { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6   22
     93            { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7   23
     94            { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8   24
     95            { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9   25
     96            { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :   26
     97            { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;   27
     98            { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <   28
     99            { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =   29
    100            { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >   30
    101            { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?   31
    102            { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @   32
    103            { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A   33
    104            { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B   34
    105            { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C   35
    106            { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D   36
    107            { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E   37
    108            { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F   38
    109            { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G   39
    110            { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H   40
    111            { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I   41
    112            { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J   42
    113            { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K   43
    114            { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L   44
    115            { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M   45
    116            { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N   46
    117            { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O   47
    118            { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P   48
    119            { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q   49
    120            { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R   50
    121            { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S   51
    122            { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T   52
    123            { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U   53
    124            { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V   54
    125            { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W   55
    126            { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X   56
    127            { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y   57
    128            { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z   58
    129            { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [   59
    130            { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55  60
    131            { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]   61
    132            { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^   62
    133            { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _   63
    134            { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '   64
    135            { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a   65
    136            { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b   66
    137            { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c   67
    138            { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d   68
    139            { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e   69
    140            { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f   70
    141            { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g   71
    142            { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h   72
    143            { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i   73
    144            { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j   74
    145            { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k   75
    146            { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l   76
    147            { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m   77
    148            { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n   78
    149            { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o   79
    150            { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p   80
    151            { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q   81
    152            { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r   82
    153            { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s   83
    154            { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t   84
    155            { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u   85
    156            { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v   86
    157            { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w   87
    158            { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x   88
    159            { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y   89
    160            { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z   90
    161            { 0x00, 0x00, 0xff, 0xff, 0x00, 0x00 },   // ||  91
    162            { 0x08, 0x1c, 0x2a, 0x08, 0x08, 0x08 },   // <-  92
    163            { 0x08, 0x08, 0x08, 0x2a, 0x1c, 0x08 },   // ->  94
    164            { 0x04, 0x02, 0xff, 0x02, 0x04, 0x00 },   // up  94
    165            { 0x00, 0x20, 0x40, 0xff, 0x40, 0x20 }    // down  95
    166          };
    167          
    168          /**************************************************************************************************
    169           *                                       GLOBAL VARIABLES
    170           **************************************************************************************************/
    171          
    172          void LCD_write_char(unsigned char c);
    173          void LCD_write_english_string(unsigned char X,unsigned char Y,uint8 *s);
    174          /**************************************************************************************************
    175           *                                       FUNCTIONS - API
    176           **************************************************************************************************/
    177          //#if (defined LCD_HW) && (HAL_LCD == TRUE) 去掉条件编译
    178          /************ 延时函数 ******************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    179          static void Delay_nms(unsigned int Time) // 延时单位:ms
   \                     Delay_nms:
    180          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    181            unsigned int i;
    182            unsigned char j;
    183          
    184            for(i=0;i<Time;i++)
   \   000000   7800         MOV     R0,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   8008         SJMP    ??Delay_nms_0
    185            {
    186              for(j=0;j<123;j++){}
   \                     ??Delay_nms_1:
   \   000006   E8           MOV     A,R0
   \   000007   2401         ADD     A,#0x1
   \   000009   08           INC     R0
   \   00000A   E9           MOV     A,R1
   \   00000B   3400         ADDC    A,#0x0
   \   00000D   F9           MOV     R1,A
   \                     ??Delay_nms_0:
   \   00000E   C3           CLR     C
   \   00000F   E8           MOV     A,R0
   \   000010   9A           SUBB    A,R2
   \   000011   E9           MOV     A,R1
   \   000012   9B           SUBB    A,R3
   \   000013   40F1         JC      ??Delay_nms_1
    187            }
    188          }
   \   000015   02....       LJMP    ?BRET
    189          
    190          /******** 发送一个字节的数据到液晶控制器*************************/
    191          static void SendByte(unsigned char Data)
    192          {
    193            unsigned char i;
    194            LCD_CE=0;
    195            for(i=0;i<8;i++)
    196            {
    197              
    198              if(Data & 0x80)
    199                LCD_SDA = 1;
    200              else 
    201                LCD_SDA = 0;
    202              Data<<=1;
    203              LCD_SCL = 0;
    204              LCD_SCL = 1;
    205              
    206            }
    207            LCD_CE=1;
    208          }
    209          
    210          /*-----------------------------------------------------------------------
    211          LCD_write_byte    : 使用SPI接口写数据到LCD
    212          
    213          输入参数：data    ：写入的数据；
    214          command ：写数据/命令选择；
    215          
    216          编写日期          ：2004-8-10
    217          最后修改日期      ：2004-8-13
    218          -----------------------------------------------------------------------*/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    219          static void LCD_write_byte(unsigned char data, unsigned char command)
   \                     LCD_write_byte:
    220          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    221            LCD_CE = 0 ;		 // 使能LCD
   \   000000   C292         CLR     0x90.2
    222          
    223            if (command == 0)
   \   000002   EA           MOV     A,R2
   \   000003   7004         JNZ     ??LCD_write_byte_0
    224              LCD_DC = 0;	        // 传送命令
   \   000005   C280         CLR     0x80.0
   \   000007   8002         SJMP    ??LCD_write_byte_1
    225            else
    226              LCD_DC = 1;		// 传送数据
   \                     ??LCD_write_byte_0:
   \   000009   D280         SETB    0x80.0
    227            SendByte(data);
   \                     ??LCD_write_byte_1:
   \   00000B   E9           MOV     A,R1
   \   00000C   FB           MOV     R3,A
   \   00000D   C292         CLR     0x90.2
   \   00000F   7A08         MOV     R2,#0x8
   \                     ??LCD_write_byte_2:
   \   000011   EB           MOV     A,R3
   \   000012   A2E7         MOV     C,0xE0 /* A   */.7
   \   000014   5004         JNC     ??LCD_write_byte_3
   \   000016   D296         SETB    0x90.6
   \   000018   8002         SJMP    ??LCD_write_byte_4
   \                     ??LCD_write_byte_3:
   \   00001A   C296         CLR     0x90.6
   \                     ??LCD_write_byte_4:
   \   00001C   C3           CLR     C
   \   00001D   33           RLC     A
   \   00001E   FB           MOV     R3,A
   \   00001F   C295         CLR     0x90.5
   \   000021   D295         SETB    0x90.5
   \   000023   1A           DEC     R2
   \   000024   EA           MOV     A,R2
   \   000025   70EA         JNZ     ??LCD_write_byte_2
   \   000027   D292         SETB    0x90.2
    228            LCD_CE = 1;	        // 关闭LCD
   \   000029   D292         SETB    0x90.2
    229            LCD_DC = 1;	
   \   00002B   D280         SETB    0x80.0
    230          }
   \   00002D   02....       LJMP    ?BRET
   \   000030                REQUIRE _A_P0
   \   000030                REQUIRE _A_P1
    231          
    232          
    233          /*-----------------------------------------------------------------------
    234          LCD_clear         : LCD清屏函数
    235          
    236          编写日期          ：2004-8-10
    237          最后修改日期      ：2004-8-10
    238          -----------------------------------------------------------------------*/
    239          static void LCD_clear(void)
    240          {
    241            unsigned int i;
    242          
    243            LCD_write_byte(0x0c, 0);
    244            LCD_write_byte(0x80, 0);
    245          
    246            for (i=0; i<504; i++)
    247              LCD_write_byte(0, 1);
    248          }
    249          
    250          /*-----------------------------------------------------------------------
    251          LCD_set_XY        : 设置LCD坐标函数
    252          
    253          输入参数：X       ：0－83
    254          Y       ：0－5
    255          
    256          编写日期          ：2004-8-10
    257          最后修改日期      ：2004-8-10
    258          -----------------------------------------------------------------------*/
    259          static void LCD_set_XY(unsigned char X, unsigned char Y)
    260          {
    261            LCD_write_byte(0x40 | Y, 0);	// column
    262            LCD_write_byte(0x80 | X, 0);  // row
    263          }
    264          
    265          /*-----------------------------------------------------------------------
    266          LCD_write_char    : 显示英文字符
    267          
    268          输入参数：c       ：显示的字符；
    269          
    270          编写日期          ：2004-8-10
    271          最后修改日期      ：2004-8-10
    272          -----------------------------------------------------------------------*/
    273          static void LCD_write_char(unsigned char c)
    274          {
    275            unsigned char line;
    276          
    277            c -= 32;
    278            for (line=0; line<6; line++)
    279              LCD_write_byte(font6x8[c][line], 1);
    280          }
    281          
    282          /*-----------------------------------------------------------------------
    283          LCD_init          : 3310LCD初始化
    284          
    285          编写日期          ：2004-8-10
    286          最后修改日期      ：2004-8-10
    287          -----------------------------------------------------------------------*/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    288          static void initLcd(void)
   \                     initLcd:
    289          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    290            // CC2430 中，I/O 口做普通 I/O 使用时和每个 I/O 端口相关的寄存器有 3 个，分别是 //PxSEL
    291            //功能选择寄存器，PxDIR 方向寄存器，PxINP 输入模式寄存器，其中 x 为 0，1，2 。
    292            
    293            //定义引脚的输出方式
    294            P0SEL &= 0xFE;//让P00为普通IO口，
   \   000005   53F3FE       ANL     0xf3,#0xfe
    295            P0DIR |= 0x01;//让P00为输出
   \   000008   43FD01       ORL     0xfd,#0x1
    296            P1SEL &= 0x93; //让P12，P15，P16为普通IO口
   \   00000B   53F493       ANL     0xf4,#0x93
   \   00000E   E5F4         MOV     A,0xf4
    297            P1DIR |= 0x6C; //把P12，P15，P16 设置为输出
   \   000010   43FE6C       ORL     0xfe,#0x6c
   \   000013   E5FE         MOV     A,0xfe
    298          
    299            P1_3=1; //封闭掉FLASH
   \   000015   D293         SETB    0x90.3
    300            LCD_CE = 1;    // 关闭LCD
   \   000017   D292         SETB    0x90.2
    301            Delay_nms(1);
   \   000019                ; Setup parameters for call to function Delay_nms
   \   000019   7A01         MOV     R2,#0x1
   \   00001B   7B00         MOV     R3,#0x0
   \   00001D   12....       LCALL   ??Delay_nms?relay
    302            LCD_CE = 0;    // 使能LCD
   \   000020   C292         CLR     0x90.2
    303            Delay_nms(1);
   \   000022                ; Setup parameters for call to function Delay_nms
   \   000022   7A01         MOV     R2,#0x1
   \   000024   7B00         MOV     R3,#0x0
   \   000026   12....       LCALL   ??Delay_nms?relay
    304          
    305            LCD_write_byte(0x21, 0);	// 使用扩展命令设置LCD模式
   \   000029                ; Setup parameters for call to function LCD_write_byte
   \   000029   7A00         MOV     R2,#0x0
   \   00002B   7921         MOV     R1,#0x21
   \   00002D   12....       LCALL   ?Subroutine2 & 0xFFFF
    306            LCD_write_byte(0xc8, 0);	// 设置偏置电压
   \                     ??CrossCallReturnLabel_5:
   \   000030   79C8         MOV     R1,#-0x38
   \   000032   12....       LCALL   ?Subroutine2 & 0xFFFF
    307            LCD_write_byte(0x06, 0);	// 温度校正
   \                     ??CrossCallReturnLabel_6:
   \   000035   7906         MOV     R1,#0x6
   \   000037   12....       LCALL   ?Subroutine2 & 0xFFFF
    308            LCD_write_byte(0x13, 0);	// 1:48
   \                     ??CrossCallReturnLabel_7:
   \   00003A   7913         MOV     R1,#0x13
   \   00003C   12....       LCALL   ?Subroutine2 & 0xFFFF
    309            LCD_write_byte(0x20, 0);	// 使用基本命令
   \                     ??CrossCallReturnLabel_8:
   \   00003F   7920         MOV     R1,#0x20
   \   000041   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000044   790C         MOV     R1,#0xc
   \   000046   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000049   7EF8         MOV     R6,#-0x8
   \   00004B   7F01         MOV     R7,#0x1
   \                     ??initLcd_0:
   \   00004D                ; Setup parameters for call to function LCD_write_byte
   \   00004D   7A01         MOV     R2,#0x1
   \   00004F   7900         MOV     R1,#0x0
   \   000051   12....       LCALL   ??LCD_write_byte?relay
   \   000054   EE           MOV     A,R6
   \   000055   24FF         ADD     A,#-0x1
   \   000057   1E           DEC     R6
   \   000058   EF           MOV     A,R7
   \   000059   34FF         ADDC    A,#-0x1
   \   00005B   FF           MOV     R7,A
   \   00005C   EE           MOV     A,R6
   \   00005D   7001         JNZ     ??initLcd_1
   \   00005F   EF           MOV     A,R7
   \                     ??initLcd_1:
   \   000060   70EB         JNZ     ??initLcd_0
    310            LCD_clear();	                // 清屏
    311            LCD_write_byte(0x0c, 0);	// 设定显示模式，正常显示
   \   000062                ; Setup parameters for call to function LCD_write_byte
   \   000062   7A00         MOV     R2,#0x0
   \   000064   790C         MOV     R1,#0xc
   \   000066   12....       LCALL   ??LCD_write_byte?relay
    312            LCD_CE=1 ;                    // 关闭LCD 芯片低电平使能
   \   000069   D292         SETB    0x90.2
    313          }
   \   00006B                REQUIRE ?Subroutine7
   \   00006B                REQUIRE _A_P1
   \   00006B                REQUIRE P0SEL
   \   00006B                REQUIRE P1SEL
   \   00006B                REQUIRE P0DIR
   \   00006B                REQUIRE P1DIR
   \   00006B                ; // Fall through to label ?Subroutine7

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL   ??LCD_write_byte?relay
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003   7A00         MOV     R2,#0x0
   \   000005   22           RET
    314          
    315          
    316          /*-----------------------------------------------------------------------
    317          LCD_write_english_String  : 英文字符串显示函数
    318          
    319          输入参数：*s      ：英文字符串指针；
    320          X、Y    : 显示字符串的位置,x 0-83 ,y 0-5
    321          
    322          编写日期          ：2004-8-10
    323          最后修改日期      ：2004-8-10 		
    324          -----------------------------------------------------------------------*/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    325           void LCD_write_english_string(unsigned char X,unsigned char Y,uint8 *s)
   \                     LCD_write_english_string:
    326          {
   \   000000   74F3         MOV     A,#-0xd
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 13
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
   \   000007   EC           MOV     A,R4
   \   000008   FE           MOV     R6,A
   \   000009   ED           MOV     A,R5
   \   00000A   FF           MOV     R7,A
    327            unsigned char i=0;
    328            LCD_set_XY(0,Y);//把第Y行清零
   \   00000B   7440         MOV     A,#0x40
   \   00000D   4A           ORL     A,R2
   \   00000E   F5..         MOV     ?V0 + 2,A
   \   000010                ; Setup parameters for call to function LCD_write_byte
   \   000010   7A00         MOV     R2,#0x0
   \   000012   F9           MOV     R1,A
   \   000013   12....       LCALL   ?Subroutine1 & 0xFFFF
    329            for(i=0;i<HAL_LCD_MAX_CHARS*6;i++)
   \                     ??CrossCallReturnLabel_4:
   \   000016   75..60       MOV     ?V0 + 0,#0x60
    330            {
    331              LCD_write_byte(0,1);
   \                     ??LCD_write_english_string_0:
   \   000019                ; Setup parameters for call to function LCD_write_byte
   \   000019   7A01         MOV     R2,#0x1
   \   00001B   7900         MOV     R1,#0x0
   \   00001D   12....       LCALL   ??LCD_write_byte?relay
    332            }
   \   000020   15..         DEC     ?V0 + 0
   \   000022   E5..         MOV     A,?V0 + 0
   \   000024   70F3         JNZ     ??LCD_write_english_string_0
    333            LCD_set_XY(X,Y);
   \   000026                ; Setup parameters for call to function LCD_write_byte
   \   000026   7A00         MOV     R2,#0x0
   \   000028   A9..         MOV     R1,?V0 + 2
   \   00002A   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   00002D   7480         MOV     A,#-0x80
   \   00002F   45..         ORL     A,?V0 + 1
   \   000031   F9           MOV     R1,A
   \   000032   12....       LCALL   ??LCD_write_byte?relay
    334            i=0;
   \   000035   75..00       MOV     ?V0 + 0,#0x0
    335            while (*s)
   \                     ??LCD_write_english_string_1:
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   FA           MOV     R2,A
   \   00003E   6045         JZ      ??LCD_write_english_string_2
    336            {
    337              LCD_write_char(*s);
   \   000040   74E0         MOV     A,#-0x20
   \   000042   2A           ADD     A,R2
   \   000043   F5..         MOV     ?V0 + 4,A
   \   000045   75..00       MOV     ?V0 + 1,#0x0
   \                     ??LCD_write_english_string_3:
   \   000048                ; Setup parameters for call to function LCD_write_byte
   \   000048   7A01         MOV     R2,#0x1
   \   00004A   85....       MOV     ?V0 + 2,?V0 + 1
   \   00004D   E5..         MOV     A,?V0 + 4
   \   00004F   75F006       MOV     B,#0x6
   \   000052   A4           MUL     AB
   \   000053   24..         ADD     A,#(font6x8 & 0xff)
   \   000055   F8           MOV     R0,A
   \   000056   E5F0         MOV     A,B
   \   000058   34..         ADDC    A,#((font6x8 >> 8) & 0xff)
   \   00005A   F9           MOV     R1,A
   \   00005B   E5..         MOV     A,?V0 + 2
   \   00005D   28           ADD     A,R0
   \   00005E   F582         MOV     DPL,A
   \   000060   E4           CLR     A
   \   000061   39           ADDC    A,R1
   \   000062   F583         MOV     DPH,A
   \   000064   E4           CLR     A
   \   000065   93           MOVC    A,@A+DPTR
   \   000066   F9           MOV     R1,A
   \   000067   12....       LCALL   ??LCD_write_byte?relay
   \   00006A   05..         INC     ?V0 + 1
   \   00006C   E5..         MOV     A,?V0 + 1
   \   00006E   C3           CLR     C
   \   00006F   9406         SUBB    A,#0x6
   \   000071   40D5         JC      ??LCD_write_english_string_3
    338              s++;
   \   000073   8E82         MOV     DPL,R6
   \   000075   8F83         MOV     DPH,R7
   \   000077   A3           INC     DPTR
   \   000078   AE82         MOV     R6,DPL
   \   00007A   AF83         MOV     R7,DPH
    339              i++;
   \   00007C   05..         INC     ?V0 + 0
    340              if(i>=HAL_LCD_MAX_CHARS)return;
   \   00007E   E5..         MOV     A,?V0 + 0
   \   000080   C3           CLR     C
   \   000081   9410         SUBB    A,#0x10
   \   000083   40B3         JC      ??LCD_write_english_string_1
   \                     ??LCD_write_english_string_2:
   \   000085   7F05         MOV     R7,#0x5
   \   000087   02....       LJMP    ?BANKED_LEAVE_XDATA
    341            }
    342          }
    343          
    344          /******************************************************************************
    345          * See lcd.h for a description of this function.
    346          ******************************************************************************/
    347          static void lcdUpdateLine(uint8 line, uint8 *pLine) {
    348            LCD_write_english_string(0,line,pLine);
    349          }
    350          
    351          //#endif
    352          
    353          /**************************************************************************************************
    354           * @fn      HalLcdInit
    355           *
    356           * @brief   Initilize LCD Service
    357           *
    358           * @param   init - pointer to void that contains the initialized value
    359           *
    360           * @return  None
    361           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    362          void HalLcdInit(void)
   \                     HalLcdInit:
    363          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    364            initLcd();
   \   000004                ; Setup parameters for call to function initLcd
   \   000004   12....       LCALL   ??initLcd?relay
    365          
    366          }
   \   000007                REQUIRE ?Subroutine6
   \   000007                ; // Fall through to label ?Subroutine6

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    367          
    368          /*************************************************************************************************
    369           *                    LCD EMULATION FUNCTIONS
    370           *
    371           * Some evaluation boards are equipped with Liquid Crystal Displays
    372           * (LCD) which may be used to display diagnostic information. These
    373           * functions provide LCD emulation, sending the diagnostic strings
    374           * to Z-Tool via the RS232 serial port. These functions are enabled
    375           * when the "LCD_SUPPORTED" compiler flag is placed in the makefile.
    376           *
    377           * Most applications update both lines (1 and 2) of the LCD whenever
    378           * text is posted to the device. This emulator assumes that line 1 is
    379           * updated first (saved locally) and the formatting and send operation
    380           * is triggered by receipt of line 2. Nothing will be transmitted if
    381           * only line 1 is updated.
    382           *
    383           *************************************************************************************************/
    384          
    385          
    386          /**************************************************************************************************
    387           * @fn      HalLcdWriteString
    388           *
    389           * @brief   Write a string to the LCD
    390           *
    391           * @param   str    - pointer to the string that will be displayed
    392           *          option - display options
    393           *
    394           * @return  None
    395           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    396          void HalLcdWriteString ( char *str, uint8 option)
   \                     HalLcdWriteString:
    397          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    398          #if (HAL_LCD == TRUE)
    399          
    400          #ifdef LCD_SD
    401            byte x;
    402            byte bln;
    403            byte sln;
    404            char *buf;
    405          
    406            if ( Lcd_Line1 == NULL )
    407            {
    408              // Set up system start-up message
    409              Lcd_Line1 = osal_mem_alloc( MAX_LCD_CHARS+1 ); //分配空间
    410              HalLcdWriteString( "Figure8 Wireless", HAL_LCD_LINE_1 );
    411            }
    412          
    413            sln = (byte)osal_strlen( str );//字符串的长度
    414          
    415            // Check boundries 检查边界
    416            if ( sln > MAX_LCD_CHARS )
    417              sln = MAX_LCD_CHARS; //最大长度
    418          
    419            if ( option == HAL_LCD_LINE_1 ) {//#define HAL_LCD_LINE_1      0x00
    420              // Line 1 gets saved for later
    421              osal_memcpy( Lcd_Line1, str, sln );//将str拷贝至 Lcd_Line1
    422              Lcd_Line1[sln] = '\0';//加一个结束符
    423            }
    424            else {
    425              // Line 2 triggers action
    426              x = (byte)osal_strlen( (char*)Lcd_Line1 );//Lcd_Line1中字符串的长度
    427              bln = x + 1 + sln + 1;//x为HAL_LCD_LINE_1中字符长度  sln为本次str中长度
    428              buf = osal_mem_alloc( bln );//总长度
    429              if ( buf != NULL ) {
    430                // Concatenate strings 连接字符串
    431                osal_memcpy( buf, Lcd_Line1, x );
    432                buf[x++] = ' ';
    433                osal_memcpy( &buf[x], str, sln );
    434                buf[x+sln] = '\0';
    435                // Send it out
    436          #ifdef ZTOOL_PORT
    437                debug_str( (byte*)buf );
    438          #endif
    439                osal_mem_free( buf );
    440              }
    441            }
    442          #endif // LCD_SD  去掉注释
    443          
    444          //#ifdef LCD_HW
    445            lcdUpdateLine( option, (uint8*)str );
   \   000004                ; Setup parameters for call to function LCD_write_english_string
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   E9           MOV     A,R1
   \   000009   FA           MOV     R2,A
   \   00000A   7900         MOV     R1,#0x0
   \   00000C   12....       LCALL   ??LCD_write_english_string?relay
    446          //#endif
    447          
    448          #endif /* HAL_LCD */
    449          
    450          }
   \   00000F   80..         SJMP    ?Subroutine6
    451          
    452          /**************************************************************************************************
    453           * @fn      HalLcdWriteValue
    454           *
    455           * @brief   Write a value to the LCD
    456           *
    457           * @param   value  - value that will be displayed
    458           *          radix  - 8, 10, 16
    459           *          option - display options
    460           *
    461           * @return  None
    462           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    463          void HalLcdWriteValue ( uint32 value, const uint8 radix, uint8 option)
   \                     HalLcdWriteValue:
    464          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7427         MOV     A,#0x27
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
    465          #if (HAL_LCD == TRUE)
    466            uint8 buf[LCD_MAX_BUF];
    467          
    468            _ltoa( value, &buf[0], radix );
   \   000011                ; Setup parameters for call to function _ltoa
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 4,DPL
   \   00001A   8583..       MOV     ?V0 + 5,DPH
   \   00001D   78..         MOV     R0,#?V0 + 4
   \   00001F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000022   12....       LCALL   ??Subroutine10_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000025   12....       LCALL   ?DEALLOC_XSTACK8
    469            HalLcdWriteString( (char*)buf, option );
   \   000028                ; Setup parameters for call to function HalLcdWriteString
   \   000028   EE           MOV     A,R6
   \   000029   F9           MOV     R1,A
   \   00002A                REQUIRE ?Subroutine8
   \   00002A                ; // Fall through to label ?Subroutine8
    470          #endif /* HAL_LCD */
    471          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   AA82         MOV     R2,DPL
   \   000008   AB83         MOV     R3,DPH
   \   00000A   12....       LCALL   ??HalLcdWriteString?relay
   \   00000D   7419         MOV     A,#0x19
   \   00000F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000012   7F06         MOV     R7,#0x6
   \   000014   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine10_0:
   \   000000   12....       LCALL   ??_ltoa?relay
   \   000003   7402         MOV     A,#0x2
   \   000005   22           RET
    472          
    473          /**************************************************************************************************
    474           * @fn      HalLcdWriteScreen
    475           *
    476           * @brief   Write a value to the LCD
    477           *
    478           * @param   line1  - string that will be displayed on line 1
    479           *          line2  - string that will be displayed on line 2
    480           *
    481           * @return  None
    482           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    483          void HalLcdWriteScreen( char *line1, char *line2 )
   \                     HalLcdWriteScreen:
    484          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EC           MOV     A,R4
   \   000006   FE           MOV     R6,A
   \   000007   ED           MOV     A,R5
   \   000008   FF           MOV     R7,A
    485          #if (HAL_LCD == TRUE)
    486            HalLcdWriteString( line1, HAL_LCD_LINE_1 );
   \   000009                ; Setup parameters for call to function HalLcdWriteString
   \   000009   7900         MOV     R1,#0x0
   \   00000B   12....       LCALL   ??HalLcdWriteString?relay
    487            HalLcdWriteString( line2, HAL_LCD_LINE_2 );
   \   00000E                ; Setup parameters for call to function HalLcdWriteString
   \   00000E   7901         MOV     R1,#0x1
   \   000010   EE           MOV     A,R6
   \   000011   FA           MOV     R2,A
   \   000012   EF           MOV     A,R7
   \   000013   FB           MOV     R3,A
   \   000014   12....       LCALL   ??HalLcdWriteString?relay
    488          #endif /* HAL_LCD */
    489          }
   \   000017   02....       LJMP    ?Subroutine7 & 0xFFFF
    490          
    491          /**************************************************************************************************
    492           * @fn      HalLcdWriteStringValue
    493           *
    494           * @brief   Write a string followed by a value to the LCD
    495           *
    496           * @param   title  -
    497           *          value  -
    498           *          format -
    499           *          line   -
    500           *
    501           * @return  None
    502           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    503          void HalLcdWriteStringValue( char *title, uint16 value, uint8 format, uint8 line )
   \                     HalLcdWriteStringValue:
    504          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7427         MOV     A,#0x27
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 5,A
    505          #if (HAL_LCD == TRUE)
    506            uint8 tmpLen;
    507            uint8 buf[LCD_MAX_BUF];
    508            uint32 err;
    509          
    510            tmpLen = (uint8)osal_strlen( (char*)title );
   \   00001C                ; Setup parameters for call to function osal_strlen
   \   00001C   12....       LCALL   ??osal_strlen?relay
    511            osal_memcpy( buf, title, tmpLen );
   \   00001F                ; Setup parameters for call to function osal_memcpy
   \   00001F   75..00       MOV     ?V0 + 2,#0x0
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000027   EA           MOV     A,R2
   \   000028   F5..         MOV     ?V0 + 0,A
   \   00002A   FC           MOV     R4,A
   \   00002B   7D00         MOV     R5,#0x0
   \   00002D   7403         MOV     A,#0x3
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??osal_memcpy?relay
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
    512            buf[tmpLen] = ' ';
   \   00003E   12....       LCALL   ?Subroutine0 & 0xFFFF
    513            err = (uint32)(value);
    514            _ltoa( err, &buf[tmpLen+1], format );
   \                     ??CrossCallReturnLabel_0:
   \   000041                ; Setup parameters for call to function _ltoa
   \   000041   A3           INC     DPTR
   \   000042   8582..       MOV     ?V0 + 0,DPL
   \   000045   8583..       MOV     ?V0 + 1,DPH
   \   000048   78..         MOV     R0,#?V0 + 0
   \   00004A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004D   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   000050   12....       LCALL   ?DEALLOC_XSTACK8
    515            HalLcdWriteString( (char*)buf, line );		
   \   000053                ; Setup parameters for call to function HalLcdWriteString
   \   000053   A9..         MOV     R1,?V0 + 5
   \   000055   02....       LJMP    ?Subroutine8 & 0xFFFF
    516          #endif /* HAL_LCD */
    517          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000003   7420         MOV     A,#0x20
   \   000005   F0           MOVX    @DPTR,A
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   E582         MOV     A,DPL
   \   000008   25..         ADD     A,?V0 + 0
   \   00000A   F582         MOV     DPL,A
   \   00000C   E583         MOV     A,DPH
   \   00000E   3400         ADDC    A,#0x0
   \   000010   F583         MOV     DPH,A
   \   000012   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   A9..         MOV     R1,?V0 + 3
   \   000002   8E..         MOV     ?V0 + 0,R6
   \   000004   8F..         MOV     ?V0 + 1,R7
   \   000006   AA..         MOV     R2,?V0 + 0
   \   000008   AB..         MOV     R3,?V0 + 1
   \   00000A                REQUIRE ??Subroutine9_0
   \   00000A                ; // Fall through to label ??Subroutine9_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine9_0:
   \   000000   7C00         MOV     R4,#0x0
   \   000002   7D00         MOV     R5,#0x0
   \   000004                REQUIRE ??Subroutine10_0
   \   000004                ; // Fall through to label ??Subroutine10_0
    518          
    519          /**************************************************************************************************
    520           * @fn      HalLcdWriteStringValue
    521           *
    522           * @brief   Write a string followed by a value to the LCD
    523           *
    524           * @param   title   -
    525           *          value1  -
    526           *          format1 -
    527           *          value2  -
    528           *          format2 -
    529           *          line    -
    530           *
    531           * @return  None
    532           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    533          void HalLcdWriteStringValueValue( char *title, uint16 value1, uint8 format1,
   \                     HalLcdWriteStringValueValue:
    534                                            uint16 value2, uint8 format2, uint8 line )
    535          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7429         MOV     A,#0x29
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 6,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 7,A
    536          #if (HAL_LCD == TRUE)
    537            uint8 tmpLen;
    538            uint8 buf[LCD_MAX_BUF];
    539            uint32 err;
    540          
    541            tmpLen = (uint8)osal_strlen( (char*)title );
   \   000020                ; Setup parameters for call to function osal_strlen
   \   000020   12....       LCALL   ??osal_strlen?relay
   \   000023   EA           MOV     A,R2
   \   000024   F5..         MOV     ?V0 + 4,A
    542            if ( tmpLen )
   \   000026   6024         JZ      ??HalLcdWriteStringValueValue_0
    543            {
    544              osal_memcpy( buf, title, tmpLen );
   \   000028                ; Setup parameters for call to function osal_memcpy
   \   000028   75..00       MOV     ?V0 + 2,#0x0
   \   00002B   78..         MOV     R0,#?V0 + 0
   \   00002D   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000030   EA           MOV     A,R2
   \   000031   F5..         MOV     ?V0 + 0,A
   \   000033   FC           MOV     R4,A
   \   000034   7D00         MOV     R5,#0x0
   \   000036   7403         MOV     A,#0x3
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   AA82         MOV     R2,DPL
   \   00003D   AB83         MOV     R3,DPH
   \   00003F   12....       LCALL   ??osal_memcpy?relay
   \   000042   7403         MOV     A,#0x3
   \   000044   12....       LCALL   ?DEALLOC_XSTACK8
    545              buf[tmpLen++] = ' ';
   \   000047   12....       LCALL   ?Subroutine0 & 0xFFFF
    546            }
   \                     ??CrossCallReturnLabel_1:
   \   00004A   05..         INC     ?V0 + 4
    547          
    548            err = (uint32)(value1);
    549            _ltoa( err, &buf[tmpLen], format1 );
   \                     ??HalLcdWriteStringValueValue_0:
   \   00004C                ; Setup parameters for call to function _ltoa
   \   00004C   85..82       MOV     DPL,?XSP + 0
   \   00004F   85..83       MOV     DPH,?XSP + 1
   \   000052   E582         MOV     A,DPL
   \   000054   25..         ADD     A,?V0 + 4
   \   000056   F5..         MOV     ?V0 + 0,A
   \   000058   E583         MOV     A,DPH
   \   00005A   3400         ADDC    A,#0x0
   \   00005C   F5..         MOV     ?V0 + 1,A
   \   00005E   78..         MOV     R0,#?V0 + 0
   \   000060   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000063   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   000066   12....       LCALL   ?DEALLOC_XSTACK8
    550            tmpLen = (uint8)osal_strlen( (char*)buf );
   \   000069                ; Setup parameters for call to function osal_strlen
   \   000069   85..82       MOV     DPL,?XSP + 0
   \   00006C   85..83       MOV     DPH,?XSP + 1
   \   00006F   AA82         MOV     R2,DPL
   \   000071   AB83         MOV     R3,DPH
   \   000073   12....       LCALL   ??osal_strlen?relay
   \   000076   EA           MOV     A,R2
   \   000077   F5..         MOV     ?V0 + 4,A
    551          
    552            buf[tmpLen++] = ',';
   \   000079   F5..         MOV     ?V0 + 0,A
   \   00007B   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   00007E   742C         MOV     A,#0x2c
   \   000080   F0           MOVX    @DPTR,A
   \   000081   05..         INC     ?V0 + 4
    553            buf[tmpLen++] = ' ';
   \   000083   85....       MOV     ?V0 + 0,?V0 + 4
   \   000086   12....       LCALL   ?Subroutine0 & 0xFFFF
    554            err = (uint32)(value2);
    555            _ltoa( err, &buf[tmpLen], format2 );
   \                     ??CrossCallReturnLabel_2:
   \   000089                ; Setup parameters for call to function _ltoa
   \   000089   7401         MOV     A,#0x1
   \   00008B   25..         ADD     A,?V0 + 4
   \   00008D   F8           MOV     R0,A
   \   00008E   85..82       MOV     DPL,?XSP + 0
   \   000091   85..83       MOV     DPH,?XSP + 1
   \   000094   E582         MOV     A,DPL
   \   000096   28           ADD     A,R0
   \   000097   F5..         MOV     ?V0 + 0,A
   \   000099   E583         MOV     A,DPH
   \   00009B   3400         ADDC    A,#0x0
   \   00009D   F5..         MOV     ?V0 + 1,A
   \   00009F   78..         MOV     R0,#?V0 + 0
   \   0000A1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A4   742D         MOV     A,#0x2d
   \   0000A6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   F9           MOV     R1,A
   \   0000AB   AA..         MOV     R2,?V0 + 6
   \   0000AD   AB..         MOV     R3,?V0 + 7
   \   0000AF   12....       LCALL   ??Subroutine9_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   0000B2   12....       LCALL   ?DEALLOC_XSTACK8
    556          
    557            HalLcdWriteString( (char *)buf, line );		
   \   0000B5                ; Setup parameters for call to function HalLcdWriteString
   \   0000B5   742C         MOV     A,#0x2c
   \   0000B7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BA   E0           MOVX    A,@DPTR
   \   0000BB   F9           MOV     R1,A
   \   0000BC   85..82       MOV     DPL,?XSP + 0
   \   0000BF   85..83       MOV     DPH,?XSP + 1
   \   0000C2   AA82         MOV     R2,DPL
   \   0000C4   AB83         MOV     R3,DPH
   \   0000C6   12....       LCALL   ??HalLcdWriteString?relay
    558          #endif /* HAL_LCD */
    559          }
   \   0000C9   7419         MOV     A,#0x19
   \   0000CB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CE   7F08         MOV     R7,#0x8
   \   0000D0   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000003   22           RET
    560          
    561          /**************************************************************************************************
    562           * @fn      HalLcdDisplayPercentBar
    563           *
    564           * @brief   Display percentage bar on the LCD
    565           *
    566           * @param   title   -
    567           *          value   -
    568           *
    569           * @return  None
    570           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    571          void HalLcdDisplayPercentBar( char *title, uint8 value )
   \                     HalLcdDisplayPercentBar:
    572          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    573          #if (HAL_LCD == TRUE)
    574            uint8 percent;
    575            uint8 leftOver;
    576            uint8 buf[HAL_LCD_MAX_CHARS+1];
    577            uint32 err;
    578            uint8 x;
    579          
    580            /* Write the title: */
    581            HalLcdWriteString( title, HAL_LCD_LINE_1 );
   \   00000C                ; Setup parameters for call to function HalLcdWriteString
   \   00000C   7900         MOV     R1,#0x0
   \   00000E   12....       LCALL   ??HalLcdWriteString?relay
    582          
    583            if ( value > 100 )
   \   000011   EE           MOV     A,R6
   \   000012   C3           CLR     C
   \   000013   9465         SUBB    A,#0x65
   \   000015   4002         JC      ??HalLcdDisplayPercentBar_0
    584              value = 100;
   \   000017   7E64         MOV     R6,#0x64
    585          
    586            /* convert to blocks */
    587            percent = (uint8)(value / 10);
   \                     ??HalLcdDisplayPercentBar_0:
   \   000019   75F00A       MOV     B,#0xa
   \   00001C   EE           MOV     A,R6
   \   00001D   84           DIV     AB
   \   00001E   F5..         MOV     ?V0 + 3,A
    588            leftOver = (uint8)(value % 10);
   \   000020   EE           MOV     A,R6
   \   000021   75F00A       MOV     B,#0xa
   \   000024   84           DIV     AB
   \   000025   AFF0         MOV     R7,B
    589          
    590            /* Make window */
    591            osal_memcpy( buf, "[          ]  ", 15 );
   \   000027                ; Setup parameters for call to function osal_memcpy
   \   000027   75....       MOV     ?V0 + 0,#(`?<Constant "[          ]  ">` & 0xff)
   \   00002A   75....       MOV     ?V0 + 1,#((`?<Constant "[          ]  ">` >> 8) & 0xff)
   \   00002D   75..00       MOV     ?V0 + 2,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000035   7C0F         MOV     R4,#0xf
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   AA82         MOV     R2,DPL
   \   000040   AB83         MOV     R3,DPH
   \   000042   12....       LCALL   ??osal_memcpy?relay
   \   000045   7403         MOV     A,#0x3
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
    592          
    593            for ( x = 0; x < percent; x ++ )
   \   00004A   7A00         MOV     R2,#0x0
   \   00004C   8004         SJMP    ??HalLcdDisplayPercentBar_1
    594            {
    595              buf[1+x] = '>';
   \                     ??HalLcdDisplayPercentBar_2:
   \   00004E   743E         MOV     A,#0x3e
   \   000050   F0           MOVX    @DPTR,A
    596            }
   \   000051   0A           INC     R2
   \                     ??HalLcdDisplayPercentBar_1:
   \   000052   8A..         MOV     ?V0 + 0,R2
   \   000054   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000057   A3           INC     DPTR
   \   000058   EA           MOV     A,R2
   \   000059   C3           CLR     C
   \   00005A   95..         SUBB    A,?V0 + 3
   \   00005C   40F0         JC      ??HalLcdDisplayPercentBar_2
    597          
    598            if ( leftOver >= 5 )
   \   00005E   EF           MOV     A,R7
   \   00005F   C3           CLR     C
   \   000060   9405         SUBB    A,#0x5
   \   000062   4003         JC      ??HalLcdDisplayPercentBar_3
    599              buf[1+x] = '+';
   \   000064   742B         MOV     A,#0x2b
   \   000066   F0           MOVX    @DPTR,A
    600          
    601            err = (uint32)value;
    602            _ltoa( err, (uint8*)&buf[13], 10 );
   \                     ??HalLcdDisplayPercentBar_3:
   \   000067                ; Setup parameters for call to function _ltoa
   \   000067   740D         MOV     A,#0xd
   \   000069   12....       LCALL   ?XSTACK_DISP0_8
   \   00006C   8582..       MOV     ?V0 + 0,DPL
   \   00006F   8583..       MOV     ?V0 + 1,DPH
   \   000072   78..         MOV     R0,#?V0 + 0
   \   000074   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000077   790A         MOV     R1,#0xa
   \   000079   EE           MOV     A,R6
   \   00007A   FA           MOV     R2,A
   \   00007B   7B00         MOV     R3,#0x0
   \   00007D   12....       LCALL   ??Subroutine9_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   000080   12....       LCALL   ?DEALLOC_XSTACK8
    603          
    604            HalLcdWriteString( (char*)buf, HAL_LCD_LINE_2 );
   \   000083                ; Setup parameters for call to function HalLcdWriteString
   \   000083   7901         MOV     R1,#0x1
   \   000085   85..82       MOV     DPL,?XSP + 0
   \   000088   85..83       MOV     DPH,?XSP + 1
   \   00008B   AA82         MOV     R2,DPL
   \   00008D   AB83         MOV     R3,DPH
   \   00008F   12....       LCALL   ??HalLcdWriteString?relay
    605          #endif /* HAL_LCD */
    606          }
   \   000092   7411         MOV     A,#0x11
   \   000094   12....       LCALL   ?DEALLOC_XSTACK8
   \   000097   7F04         MOV     R7,#0x4
   \   000099   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL   ??LCD_write_byte?relay
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003                ; Setup parameters for call to function LCD_write_byte
   \   000003   7A00         MOV     R2,#0x0
   \   000005   7980         MOV     R1,#-0x80
   \   000007   12....       LCALL   ??LCD_write_byte?relay
   \   00000A   22           RET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Delay_nms?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Delay_nms

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??LCD_write_byte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    LCD_write_byte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??initLcd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    initLcd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??LCD_write_english_string?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    LCD_write_english_string

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteString?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteString

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteScreen?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteScreen

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValueValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValueValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdDisplayPercentBar?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdDisplayPercentBar

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "[          ]  ">`:
   \   000000   5B202020     DB "[          ]  "
   \            20202020
   \            2020205D
   \            202000  
    607          
    608          /**************************************************************************************************
    609          **************************************************************************************************/
    610          
    611          
    612          

   Maximum stack usage in bytes:

     Function                      ISTACK PSTACK XSTACK
     --------                      ------ ------ ------
     Delay_nms                         0      0      9
     HalLcdDisplayPercentBar           1      0     32
       -> HalLcdWriteString            0      0     58
       -> osal_memcpy                  0      0     64
       -> _ltoa                        0      0     62
       -> HalLcdWriteString            0      0     58
     HalLcdInit                        2      0      0
       -> initLcd                      4      0      0
     HalLcdWriteScreen                 0      0      9
       -> HalLcdWriteString            0      0     18
       -> HalLcdWriteString            0      0     18
     HalLcdWriteString                 2      0     41
       -> LCD_write_english_string     4      0      0
     HalLcdWriteStringValue            1      0     43
       -> osal_strlen                  0      0     78
       -> osal_memcpy                  0      0     84
       -> _ltoa                        0      0     82
       -> HalLcdWriteString            0      0     78
     HalLcdWriteStringValueValue       1      0     48
       -> osal_strlen                  0      0     82
       -> osal_memcpy                  0      0     88
       -> _ltoa                        0      0     86
       -> osal_strlen                  0      0     82
       -> _ltoa                        0      0     86
       -> HalLcdWriteString            0      0     82
     HalLcdWriteValue                  0      0     42
       -> _ltoa                        0      0     82
       -> HalLcdWriteString            0      0     78
     LCD_write_byte                    0      0     13
     LCD_write_english_string          0      0     13
       -> LCD_write_byte               0      0     26
       -> LCD_write_byte               0      0     26
       -> LCD_write_byte               0      0     26
       -> LCD_write_byte               0      0     26
       -> LCD_write_byte               0      0     26
       -> LCD_write_byte               0      0     26
     initLcd                           0      0      9
       -> Delay_nms                    0      0     18
       -> Delay_nms                    0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18
       -> LCD_write_byte               0      0     18


   Segment part sizes:

     Function/Label                      Bytes
     --------------                      -----
     _A_P0                                  1
     _A_P1                                  1
     P0SEL                                  1
     P1SEL                                  1
     P0DIR                                  1
     P1DIR                                  1
     font6x8                              576
     Delay_nms                             24
     LCD_write_byte                        48
     initLcd                              107
     ?Subroutine7                           5
     ?Subroutine2                           6
     LCD_write_english_string             138
     HalLcdInit                             7
     ?Subroutine6                           7
     HalLcdWriteString                     17
     HalLcdWriteValue                      42
     ?Subroutine8                          23
     ??Subroutine10_0                       6
     HalLcdWriteScreen                     26
     HalLcdWriteStringValue                88
     ?Subroutine0                           7
     ?Subroutine5                          19
     ?Subroutine3                          10
     ??Subroutine9_0                        4
     HalLcdWriteStringValueValue          211
     ?Subroutine4                           4
     HalLcdDisplayPercentBar              156
     ?Subroutine1                          11
     ??Delay_nms?relay                      6
     ??LCD_write_byte?relay                 6
     ??initLcd?relay                        6
     ??LCD_write_english_string?relay       6
     ??HalLcdInit?relay                     6
     ??HalLcdWriteString?relay              6
     ??HalLcdWriteValue?relay               6
     ??HalLcdWriteScreen?relay              6
     ??HalLcdWriteStringValue?relay         6
     ??HalLcdWriteStringValueValue?relay    6
     ??HalLcdDisplayPercentBar?relay        6
     ?<Constant "[          ]  ">          15

 
 966 bytes in segment BANKED_CODE
  66 bytes in segment BANK_RELAYS
 576 bytes in segment CODE_C
   6 bytes in segment SFR_AN
  15 bytes in segment XDATA_ROM_C
 
 1 608 bytes of CODE  memory
    15 bytes of CONST memory
     0 bytes of DATA  memory (+ 6 bytes shared)

Errors: none
Warnings: none
