###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.51A/W32 for 8051                08/Apr/2013  11:22:34 #
# Copyright 2004-2009 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Com #
#                          ponents\hal\target\CC2530EB\hal_lcd.c              #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0 #
#                          \Projects\zstack\Samples\WSN_sensors\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wRouter.cfg" (-DCPU32MHZ     #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DRTR_NWK -DBLINK_LEDS) -f "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wConfig.cfg" (-DSECURE=0                  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Co #
#                          mponents\hal\target\CC2530EB\hal_lcd.c" -D         #
#                          ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC  #
#                          -D LCD_SUPPORTED=DEBUG -lC "C:\Texas               #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\RouterEB\List\"   #
#                          -lA "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3. #
#                          0\Projects\zstack\Samples\WSN_sensors\CC2530DB\Rou #
#                          terEB\List\" --diag_suppress Pe001,Pa010 -o        #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\WSN_sensors\CC2530DB\RouterE #
#                          B\Obj\" -e --require_prototypes --no_unroll        #
#                          --no_inline --no_tbaa --debug --core=plain         #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 8 -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\" -I "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\SOURCE\" -I    #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\WSN_sensors\CC2530DB\..\..\. #
#                          .\ZMAIN\TI2530DB\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MT\" -I "C:\Texas                         #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\TARGET\CC2530EB\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\INCLUDE\" -I "C:\Texas               #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\AF\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\NWK\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SEC\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SAPI\" -I "C:\Texas                 #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SYS\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\ZDO\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\F8W\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\" -I "C:\Texas                       #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SADDR\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SDATA\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\" -I      #
#                          "D:\Program Files\IAR Systems\Embedded Workbench   #
#                          5.3\8051\INC\" -I "D:\Program Files\IAR            #
#                          Systems\Embedded Workbench 5.3\8051\INC\CLIB\" -Om #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\WSN_sensors\CC2530DB\RouterEB #
#                          \List\hal_lcd.lst                                  #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\WSN_sensors\CC2530DB\RouterEB #
#                          \Obj\hal_lcd.r51                                   #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Components\hal\target\CC2530EB\hal_lcd.c
      1          /**************************************************************************************************
      2            Filename:       hal_lcd.c
      3            Revised:        $Date: 2009-03-12 16:25:22 -0700 (Thu, 12 Mar 2009) $
      4            Revision:       $Revision: 19404 $
      5          
      6            Description:    This file contains the interface to the HAL LCD Service.
      7          
      8          
      9            Copyright 2007 - 2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /**************************************************************************************************
     41           *                                           INCLUDES
     42           **************************************************************************************************/
     43          #include "hal_types.h"
     44          #include "hal_lcd.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf1
   \   unsigned char volatile __sfr PERCFG
   \                     PERCFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf3
   \   unsigned char volatile __sfr P0SEL
   \                     P0SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf8
   \   union <unnamed> volatile __sfr _A_U1CSR
   \                     _A_U1CSR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf9
   \   unsigned char volatile __sfr U1DBUF
   \                     U1DBUF:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfa
   \   unsigned char volatile __sfr U1BAUD
   \                     U1BAUD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfb
   \   unsigned char volatile __sfr U1UCR
   \                     U1UCR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfc
   \   unsigned char volatile __sfr U1GCR
   \                     U1GCR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     45          #include "OSAL.h"
     46          #include "OnBoard.h"
     47          #include "hal_assert.h"
     48          
     49          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
     50            #include "DebugTrace.h"
     51          #endif
     52          
     53          /**************************************************************************************************
     54           *                                          CONSTANTS
     55           **************************************************************************************************/
     56          /*
     57            LCD pins
     58          
     59            //control
     60            P0.0 - LCD_MODE
     61            P1.1 - LCD_FLASH_RESET
     62            P1.2 - LCD_CS
     63          
     64            //spi
     65            P1.5 - CLK
     66            P1.6 - MOSI
     67            P1.7 - MISO
     68          */
     69          
     70          /* LCD Control lines */
     71          #define HAL_LCD_MODE_PORT 0
     72          #define HAL_LCD_MODE_PIN  0
     73          
     74          #define HAL_LCD_RESET_PORT 1
     75          #define HAL_LCD_RESET_PIN  1
     76          
     77          #define HAL_LCD_CS_PORT 1
     78          #define HAL_LCD_CS_PIN  2
     79          
     80          /* LCD SPI lines */
     81          #define HAL_LCD_CLK_PORT 1
     82          #define HAL_LCD_CLK_PIN  5
     83          
     84          #define HAL_LCD_MOSI_PORT 1
     85          #define HAL_LCD_MOSI_PIN  6
     86          
     87          #define HAL_LCD_MISO_PORT 1
     88          #define HAL_LCD_MISO_PIN  7
     89          
     90          /* SPI settings */
     91          #define HAL_SPI_CLOCK_POL_LO       0x00
     92          #define HAL_SPI_CLOCK_PHA_0        0x00
     93          #define HAL_SPI_TRANSFER_MSB_FIRST 0x20
     94          
     95          /* LCD lines */
     96          #define LCD_MAX_LINE_COUNT              3
     97          #define LCD_MAX_LINE_LENGTH             16
     98          #define LCD_MAX_BUF                     25
     99          
    100          /* Defines for HW LCD */
    101          
    102          /* Set power save mode */
    103          #define OSC_OFF                         0x00
    104          #define OSC_ON                          0x01
    105          #define POWER_SAVE_OFF                  0x00
    106          #define POWER_SAVE_ON                   0x02
    107          #define SET_POWER_SAVE_MODE(options)    HalLcd_HW_Control(0x0C | (options))
    108          
    109          /* Function Set */
    110          #define CGROM                           0x00
    111          #define CGRAM                           0x01
    112          #define COM_FORWARD                     0x00
    113          #define COM_BACKWARD                    0x02
    114          #define TWO_LINE                        0x00
    115          #define THREE_LINE                      0x04
    116          #define FUNCTION_SET(options)           HalLcd_HW_Control(0x10 | (options))
    117          
    118          /* Set Display Start Line */
    119          #define LINE1                           0x00
    120          #define LINE2                           0x01
    121          #define LINE3                           0x02
    122          #define LINE4                           0x03
    123          #define SET_DISPLAY_START_LINE(line)    HalLcd_HW_Control(0x18 | (line))
    124          
    125          /* Bias control */
    126          #define BIAS_1_5                        0x00
    127          #define BIAS_1_4                        0x01
    128          #define SET_BIAS_CTRL(bias)             HalLcd_HW_Control(0x1C | (bias))
    129          
    130          /* Power control */
    131          #define VOLTAGE_DIVIDER_OFF             0x00
    132          #define VOLTAGE_DIVIDER_ON              0x01
    133          #define CONVERTER_AND_REG_OFF           0x00
    134          #define CONVERTER_AND_REG_ON            0x04
    135          #define SET_POWER_CTRL(options)         HalLcd_HW_Control(0x20 | (options))
    136          
    137          // Set display control
    138          #define DISPLAY_CTRL_ON                 0x01
    139          #define DISPLAY_CTRL_OFF                0x00
    140          #define DISPLAY_CTRL_BLINK_ON           0x02
    141          #define DISPLAY_CTRL_BLINK_OFF          0x00
    142          #define DISPLAY_CTRL_CURSOR_ON          0x04
    143          #define DISPLAY_CTRL_CURSOR_OFF         0x00
    144          #define SET_DISPLAY_CTRL(options)       HalLcd_HW_Control(0x28 | (options))
    145          
    146          /* Set DD/ CGRAM address */
    147          #define SET_DDRAM_ADDR(charIndex)       HalLcd_HW_Control(0x80 | (charIndex))
    148          #define SET_GCRAM_CHAR(specIndex)       HalLcd_HW_Control(0xC0 | (specIndex))
    149          
    150          /* Set ICONRAM address */
    151          #define CONTRAST_CTRL_REGISTER          0x10
    152          #define SET_ICONRAM_ADDR(addr)          HalLcd_HW_Control(0x40 | (addr))
    153          
    154          /* Set double height */
    155          #define LINE_1_AND_2                    0x01
    156          #define LINE_2_AND_3                    0x02
    157          #define NORMAL_DISPLAY                  0x00
    158          #define SET_DOUBLE_HEIGHT(options)      HalLcd_HW_Control(0x08 | (options))
    159          
    160          /**************************************************************************************************
    161           *                                           MACROS
    162           **************************************************************************************************/
    163          
    164          #define HAL_IO_SET(port, pin, val)        HAL_IO_SET_PREP(port, pin, val)
    165          #define HAL_IO_SET_PREP(port, pin, val)   st( P##port##_##pin## = val; )
    166          
    167          #define HAL_CONFIG_IO_OUTPUT(port, pin, val)      HAL_CONFIG_IO_OUTPUT_PREP(port, pin, val)
    168          #define HAL_CONFIG_IO_OUTPUT_PREP(port, pin, val) st( P##port##SEL &= ~BV(pin); \
    169                                                                P##port##_##pin## = val; \
    170                                                                P##port##DIR |= BV(pin); )
    171          
    172          #define HAL_CONFIG_IO_PERIPHERAL(port, pin)      HAL_CONFIG_IO_PERIPHERAL_PREP(port, pin)
    173          #define HAL_CONFIG_IO_PERIPHERAL_PREP(port, pin) st( P##port##SEL |= BV(pin); )
    174          
    175          
    176          
    177          /* SPI interface control */
    178          #define LCD_SPI_BEGIN()     HAL_IO_SET(HAL_LCD_CS_PORT,  HAL_LCD_CS_PIN,  0); /* chip select */
    179          #define LCD_SPI_END()                                                         \
    180          {                                                                             \
    181            asm("NOP");                                                                 \
    182            asm("NOP");                                                                 \
    183            asm("NOP");                                                                 \
    184            asm("NOP");                                                                 \
    185            HAL_IO_SET(HAL_LCD_CS_PORT,  HAL_LCD_CS_PIN,  1); /* chip select */         \
    186          }
    187          /* clear the received and transmit byte status, write tx data to buffer, wait till transmit done */
    188          #define LCD_SPI_TX(x)                   { U1CSR &= ~(BV(2) | BV(1)); U1DBUF = x; while( !(U1CSR & BV(1)) ); }
    189          #define LCD_SPI_WAIT_RXRDY()            { while(!(U1CSR & BV(1))); }
    190          
    191          
    192          /* Control macros */
    193          #define LCD_DO_WRITE()        HAL_IO_SET(HAL_LCD_MODE_PORT,  HAL_LCD_MODE_PIN,  1);
    194          #define LCD_DO_CONTROL()      HAL_IO_SET(HAL_LCD_MODE_PORT,  HAL_LCD_MODE_PIN,  0);
    195          
    196          #define LCD_ACTIVATE_RESET()  HAL_IO_SET(HAL_LCD_RESET_PORT, HAL_LCD_RESET_PIN, 0);
    197          #define LCD_RELEASE_RESET()   HAL_IO_SET(HAL_LCD_RESET_PORT, HAL_LCD_RESET_PIN, 1);
    198          
    199          
    200          /**************************************************************************************************
    201           *                                       GLOBAL VARIABLES
    202           **************************************************************************************************/

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    203          static uint8 *Lcd_Line1;
   \                     Lcd_Line1:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    204          
    205          /**************************************************************************************************
    206           *                                       FUNCTIONS - API
    207           **************************************************************************************************/
    208          #if (HAL_LCD == TRUE)
    209          void HalLcd_HW_Init(void);
    210          void HalLcd_HW_WaitUs(uint16 i);
    211          void HalLcd_HW_Clear(void);
    212          void HalLcd_HW_ClearAllSpecChars(void);
    213          void HalLcd_HW_Control(uint8 cmd);
    214          void HalLcd_HW_Write(uint8 data);
    215          void HalLcd_HW_SetContrast(uint8 value);
    216          void HalLcd_HW_WriteChar(uint8 line, uint8 col, char text);
    217          void HalLcd_HW_WriteLine(uint8 line, const char *pText);
    218          #endif //LCD
    219          
    220          /**************************************************************************************************
    221           * @fn      HalLcdInit
    222           *
    223           * @brief   Initilize LCD Service
    224           *
    225           * @param   init - pointer to void that contains the initialized value
    226           *
    227           * @return  None
    228           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    229          void HalLcdInit(void)
   \                     HalLcdInit:
    230          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    231            Lcd_Line1 = NULL;
   \   000004   90....       MOV     DPTR,#Lcd_Line1
   \   000007   E4           CLR     A
   \   000008   F0           MOVX    @DPTR,A
   \   000009   A3           INC     DPTR
   \   00000A   F0           MOVX    @DPTR,A
    232          #if (HAL_LCD == TRUE)
    233            HalLcd_HW_Init();
   \   00000B                ; Setup parameters for call to function HalLcd_HW_Init
   \   00000B   12....       LCALL   ??HalLcd_HW_Init?relay
    234          #endif
    235          }
   \   00000E   D083         POP     DPH
   \   000010   D082         POP     DPL
   \   000012   02....       LJMP    ?BRET
    236          
    237          /*************************************************************************************************
    238           *                    LCD EMULATION FUNCTIONS
    239           *
    240           * Some evaluation boards are equipped with Liquid Crystal Displays
    241           * (LCD) which may be used to display diagnostic information. These
    242           * functions provide LCD emulation, sending the diagnostic strings
    243           * to Z-Tool via the RS232 serial port. These functions are enabled
    244           * when the "LCD_SUPPORTED" compiler flag is placed in the makefile.
    245           *
    246           * Most applications update both lines (1 and 2) of the LCD whenever
    247           * text is posted to the device. This emulator assumes that line 1 is
    248           * updated first (saved locally) and the formatting and send operation
    249           * is triggered by receipt of line 2. Nothing will be transmitted if
    250           * only line 1 is updated.
    251           *
    252           *************************************************************************************************/
    253          
    254          
    255          /**************************************************************************************************
    256           * @fn      HalLcdWriteString
    257           *
    258           * @brief   Write a string to the LCD
    259           *
    260           * @param   str    - pointer to the string that will be displayed
    261           *          option - display options
    262           *
    263           * @return  None
    264           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    265          void HalLcdWriteString ( char *str, uint8 option)
   \                     HalLcdWriteString:
    266          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   \   000015   89..         MOV     ?V0 + 1,R1
    267          #if (HAL_LCD == TRUE)
    268          
    269            uint8 strLen = 0;
    270            uint8 totalLen = 0;
    271            uint8 *buf;
    272            uint8 tmpLen;
    273          
    274            if ( Lcd_Line1 == NULL )
   \   000017   90....       MOV     DPTR,#Lcd_Line1
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   7002         JNZ     ??HalLcdWriteString_0
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \                     ??HalLcdWriteString_0:
   \   00001F   7018         JNZ     ??HalLcdWriteString_1
    275            {
    276              Lcd_Line1 = osal_mem_alloc( HAL_LCD_MAX_CHARS+1 );
   \   000021                ; Setup parameters for call to function osal_mem_alloc
   \   000021   7A11         MOV     R2,#0x11
   \   000023   7B00         MOV     R3,#0x0
   \   000025   12....       LCALL   ??osal_mem_alloc?relay
   \   000028   90....       MOV     DPTR,#Lcd_Line1
   \   00002B   EA           MOV     A,R2
   \   00002C   F0           MOVX    @DPTR,A
   \   00002D   A3           INC     DPTR
   \   00002E   EB           MOV     A,R3
   \   00002F   F0           MOVX    @DPTR,A
    277              HalLcdWriteString( "Texas Instruments", 1 );
   \   000030                ; Setup parameters for call to function HalLcdWriteString
   \   000030   7901         MOV     R1,#0x1
   \   000032   7A..         MOV     R2,#(`?<Constant "Texas Instruments">` & 0xff)
   \   000034   7B..         MOV     R3,#((`?<Constant "Texas Instruments">` >> 8) & 0xff)
   \   000036   12....       LCALL   ??HalLcdWriteString?relay
    278            }
    279          
    280            strLen = (uint8)osal_strlen( (char*)str );
   \                     ??HalLcdWriteString_1:
   \   000039                ; Setup parameters for call to function osal_strlen
   \   000039   85..82       MOV     DPL,?XSP + 0
   \   00003C   85..83       MOV     DPH,?XSP + 1
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   FA           MOV     R2,A
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   FB           MOV     R3,A
   \   000044   12....       LCALL   ??osal_strlen?relay
   \   000047   EA           MOV     A,R2
   \   000048   F5..         MOV     ?V0 + 2,A
    281          
    282            /* Check boundries */
    283            if ( strLen > HAL_LCD_MAX_CHARS )
   \   00004A   C3           CLR     C
   \   00004B   9411         SUBB    A,#0x11
   \   00004D   4003         JC      ??HalLcdWriteString_2
    284              strLen = HAL_LCD_MAX_CHARS;
   \   00004F   75..10       MOV     ?V0 + 2,#0x10
    285          
    286            if ( option == HAL_LCD_LINE_1 )
   \                     ??HalLcdWriteString_2:
   \   000052   7401         MOV     A,#0x1
   \   000054   65..         XRL     A,?V0 + 1
   \   000056   7042         JNZ     ??HalLcdWriteString_3
    287            {
    288              /* Line 1 gets saved for later */
    289              osal_memcpy( Lcd_Line1, str, strLen );
   \   000058                ; Setup parameters for call to function osal_memcpy
   \   000058   85..82       MOV     DPL,?XSP + 0
   \   00005B   85..83       MOV     DPH,?XSP + 1
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   F5..         MOV     ?V0 + 4,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F5..         MOV     ?V0 + 5,A
   \   000065   75..00       MOV     ?V0 + 6,#0x0
   \   000068   78..         MOV     R0,#?V0 + 4
   \   00006A   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00006D   AC..         MOV     R4,?V0 + 2
   \   00006F   7D00         MOV     R5,#0x0
   \   000071   90....       MOV     DPTR,#Lcd_Line1
   \   000074   E0           MOVX    A,@DPTR
   \   000075   FA           MOV     R2,A
   \   000076   A3           INC     DPTR
   \   000077   E0           MOVX    A,@DPTR
   \   000078   FB           MOV     R3,A
   \   000079   12....       LCALL   ??osal_memcpy?relay
   \   00007C   7403         MOV     A,#0x3
   \   00007E   12....       LCALL   ?DEALLOC_XSTACK8
    290              Lcd_Line1[strLen] = '\0';
   \   000081   E4           CLR     A
   \   000082   C0E0         PUSH    A
   \   000084   A8..         MOV     R0,?V0 + 2
   \   000086   90....       MOV     DPTR,#Lcd_Line1
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   28           ADD     A,R0
   \   00008B   FA           MOV     R2,A
   \   00008C   A3           INC     DPTR
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   3400         ADDC    A,#0x0
   \   000090   8A82         MOV     DPL,R2
   \   000092   F583         MOV     DPH,A
   \   000094   D0E0         POP     A
   \   000096   F0           MOVX    @DPTR,A
   \   000097   02....       LJMP    ??HalLcdWriteString_4 & 0xFFFF
    291            }
    292            else
    293            {
    294              /* Line 2 triggers action */
    295              tmpLen = (uint8)osal_strlen( (char*)Lcd_Line1 );
   \                     ??HalLcdWriteString_3:
   \   00009A                ; Setup parameters for call to function osal_strlen
   \   00009A   90....       MOV     DPTR,#Lcd_Line1
   \   00009D   E0           MOVX    A,@DPTR
   \   00009E   FA           MOV     R2,A
   \   00009F   A3           INC     DPTR
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   FB           MOV     R3,A
   \   0000A2   12....       LCALL   ??osal_strlen?relay
   \   0000A5   EA           MOV     A,R2
   \   0000A6   F5..         MOV     ?V0 + 0,A
    296              totalLen =  tmpLen + 1 + strLen + 1;
    297              buf = osal_mem_alloc( totalLen );
   \   0000A8                ; Setup parameters for call to function osal_mem_alloc
   \   0000A8   E5..         MOV     A,?V0 + 2
   \   0000AA   25..         ADD     A,?V0 + 0
   \   0000AC   2402         ADD     A,#0x2
   \   0000AE   FA           MOV     R2,A
   \   0000AF   7B00         MOV     R3,#0x0
   \   0000B1   12....       LCALL   ??osal_mem_alloc?relay
   \   0000B4   8A..         MOV     ?V0 + 4,R2
   \   0000B6   8B..         MOV     ?V0 + 5,R3
   \   0000B8   AE..         MOV     R6,?V0 + 4
   \   0000BA   AF..         MOV     R7,?V0 + 5
    298              if ( buf != NULL )
   \   0000BC   EE           MOV     A,R6
   \   0000BD   7001         JNZ     ??HalLcdWriteString_5
   \   0000BF   EF           MOV     A,R7
   \                     ??HalLcdWriteString_5:
   \   0000C0   7003         JNZ     $+5
   \   0000C2   02....       LJMP    ??HalLcdWriteString_4 & 0xFFFF
    299              {
    300                /* Concatenate strings */
    301                osal_memcpy( buf, Lcd_Line1, tmpLen );
   \   0000C5                ; Setup parameters for call to function osal_memcpy
   \   0000C5   90....       MOV     DPTR,#Lcd_Line1
   \   0000C8   E0           MOVX    A,@DPTR
   \   0000C9   F5..         MOV     ?V0 + 4,A
   \   0000CB   A3           INC     DPTR
   \   0000CC   E0           MOVX    A,@DPTR
   \   0000CD   F5..         MOV     ?V0 + 5,A
   \   0000CF   75..00       MOV     ?V0 + 6,#0x0
   \   0000D2   78..         MOV     R0,#?V0 + 4
   \   0000D4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000D7   AC..         MOV     R4,?V0 + 0
   \   0000D9   7D00         MOV     R5,#0x0
   \   0000DB   12....       LCALL   ??osal_memcpy?relay
   \   0000DE   7403         MOV     A,#0x3
   \   0000E0   12....       LCALL   ?DEALLOC_XSTACK8
    302                buf[tmpLen++] = ' ';
   \   0000E3   7420         MOV     A,#0x20
   \   0000E5   C0E0         PUSH    A
   \   0000E7   85....       MOV     ?V0 + 4,?V0 + 0
   \   0000EA   EE           MOV     A,R6
   \   0000EB   25..         ADD     A,?V0 + 4
   \   0000ED   F582         MOV     DPL,A
   \   0000EF   EF           MOV     A,R7
   \   0000F0   3400         ADDC    A,#0x0
   \   0000F2   F583         MOV     DPH,A
   \   0000F4   D0E0         POP     A
   \   0000F6   F0           MOVX    @DPTR,A
   \   0000F7   05..         INC     ?V0 + 0
   \   0000F9                ; Setup parameters for call to function osal_memcpy
   \   0000F9   85..82       MOV     DPL,?XSP + 0
   \   0000FC   85..83       MOV     DPH,?XSP + 1
   \   0000FF   E0           MOVX    A,@DPTR
   \   000100   F5..         MOV     ?V0 + 4,A
   \   000102   A3           INC     DPTR
   \   000103   E0           MOVX    A,@DPTR
   \   000104   F5..         MOV     ?V0 + 5,A
   \   000106   78..         MOV     R0,#?V0 + 4
   \   000108   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00010B   AC..         MOV     R4,?V0 + 2
   \   00010D   7D00         MOV     R5,#0x0
   \   00010F   85....       MOV     ?V0 + 4,?V0 + 0
   \   000112   EE           MOV     A,R6
   \   000113   25..         ADD     A,?V0 + 4
   \   000115   FA           MOV     R2,A
   \   000116   EF           MOV     A,R7
   \   000117   3400         ADDC    A,#0x0
   \   000119   FB           MOV     R3,A
    303                osal_memcpy( &buf[tmpLen], str, strLen );
   \   00011A   12....       LCALL   ??osal_memcpy?relay
   \   00011D   7403         MOV     A,#0x3
   \   00011F   12....       LCALL   ?DEALLOC_XSTACK8
    304                buf[tmpLen+strLen] = '\0';
   \   000122   E4           CLR     A
   \   000123   C0E0         PUSH    A
   \   000125   E5..         MOV     A,?V0 + 2
   \   000127   25..         ADD     A,?V0 + 4
   \   000129   F8           MOV     R0,A
   \   00012A   E4           CLR     A
   \   00012B   3400         ADDC    A,#0x0
   \   00012D   F9           MOV     R1,A
   \   00012E   EE           MOV     A,R6
   \   00012F   28           ADD     A,R0
   \   000130   F582         MOV     DPL,A
   \   000132   EF           MOV     A,R7
   \   000133   39           ADDC    A,R1
   \   000134   F583         MOV     DPH,A
   \   000136   D0E0         POP     A
   \   000138   F0           MOVX    @DPTR,A
    305          
    306                /* Send it out */
    307          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    308          
    309          #if defined(SERIAL_DEBUG_SUPPORTED)
    310                debug_str( (uint8*)buf );
   \   000139                ; Setup parameters for call to function debug_str
   \   000139   EE           MOV     A,R6
   \   00013A   FA           MOV     R2,A
   \   00013B   EF           MOV     A,R7
   \   00013C   FB           MOV     R3,A
   \   00013D   12....       LCALL   ??debug_str?relay
    311          #endif //LCD_SUPPORTED
    312          
    313          #endif //ZTOOL_P1
    314          
    315                /* Free mem */
    316                osal_mem_free( buf );
   \   000140                ; Setup parameters for call to function osal_mem_free
   \   000140   EE           MOV     A,R6
   \   000141   FA           MOV     R2,A
   \   000142   EF           MOV     A,R7
   \   000143   FB           MOV     R3,A
   \   000144   12....       LCALL   ??osal_mem_free?relay
    317              }
    318            }
    319          
    320            /* Display the string */
    321            HalLcd_HW_WriteLine (option, str);
   \                     ??HalLcdWriteString_4:
   \   000147                ; Setup parameters for call to function HalLcd_HW_WriteLine
   \   000147   85..82       MOV     DPL,?XSP + 0
   \   00014A   85..83       MOV     DPH,?XSP + 1
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   FA           MOV     R2,A
   \   00014F   A3           INC     DPTR
   \   000150   E0           MOVX    A,@DPTR
   \   000151   FB           MOV     R3,A
   \   000152   A9..         MOV     R1,?V0 + 1
   \   000154   12....       LCALL   ??HalLcd_HW_WriteLine?relay
    322          
    323          #endif //HAL_LCD
    324          
    325          }
   \   000157   7402         MOV     A,#0x2
   \   000159   12....       LCALL   ?DEALLOC_XSTACK8
   \   00015C   7F07         MOV     R7,#0x7
   \   00015E   02....       LJMP    ?BANKED_LEAVE_XDATA
    326          
    327          /**************************************************************************************************
    328           * @fn      HalLcdWriteValue
    329           *
    330           * @brief   Write a value to the LCD
    331           *
    332           * @param   value  - value that will be displayed
    333           *          radix  - 8, 10, 16
    334           *          option - display options
    335           *
    336           * @return  None
    337           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    338          void HalLcdWriteValue ( uint32 value, const uint8 radix, uint8 option)
   \                     HalLcdWriteValue:
    339          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7427         MOV     A,#0x27
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
    340          #if (HAL_LCD == TRUE)
    341            uint8 buf[LCD_MAX_BUF];
    342          
    343            _ltoa( value, &buf[0], radix );
   \   000011                ; Setup parameters for call to function _ltoa
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 4,DPL
   \   00001A   8583..       MOV     ?V0 + 5,DPH
   \   00001D   78..         MOV     R0,#?V0 + 4
   \   00001F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000022   12....       LCALL   ??_ltoa?relay
   \   000025   7402         MOV     A,#0x2
   \   000027   12....       LCALL   ?DEALLOC_XSTACK8
    344            HalLcdWriteString( (char*)buf, option );
   \   00002A                ; Setup parameters for call to function HalLcdWriteString
   \   00002A   EE           MOV     A,R6
   \   00002B   F9           MOV     R1,A
   \   00002C   85..82       MOV     DPL,?XSP + 0
   \   00002F   85..83       MOV     DPH,?XSP + 1
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??HalLcdWriteString?relay
    345          #endif
    346          }
   \   000039   7419         MOV     A,#0x19
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003E   7F06         MOV     R7,#0x6
   \   000040   02....       LJMP    ?BANKED_LEAVE_XDATA
    347          
    348          /**************************************************************************************************
    349           * @fn      HalLcdWriteScreen
    350           *
    351           * @brief   Write a value to the LCD
    352           *
    353           * @param   line1  - string that will be displayed on line 1
    354           *          line2  - string that will be displayed on line 2
    355           *
    356           * @return  None
    357           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    358          void HalLcdWriteScreen( char *line1, char *line2 )
   \                     HalLcdWriteScreen:
    359          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EC           MOV     A,R4
   \   000006   FE           MOV     R6,A
   \   000007   ED           MOV     A,R5
   \   000008   FF           MOV     R7,A
    360          #if (HAL_LCD == TRUE)
    361            HalLcdWriteString( line1, 1 );
   \   000009                ; Setup parameters for call to function HalLcdWriteString
   \   000009   7901         MOV     R1,#0x1
   \   00000B   12....       LCALL   ??HalLcdWriteString?relay
    362            HalLcdWriteString( line2, 2 );
   \   00000E                ; Setup parameters for call to function HalLcdWriteString
   \   00000E   7902         MOV     R1,#0x2
   \   000010   EE           MOV     A,R6
   \   000011   FA           MOV     R2,A
   \   000012   EF           MOV     A,R7
   \   000013   FB           MOV     R3,A
   \   000014   12....       LCALL   ??HalLcdWriteString?relay
    363          #endif
    364          }
   \   000017   7F01         MOV     R7,#0x1
   \   000019   02....       LJMP    ?BANKED_LEAVE_XDATA
    365          
    366          /**************************************************************************************************
    367           * @fn      HalLcdWriteStringValue
    368           *
    369           * @brief   Write a string followed by a value to the LCD
    370           *
    371           * @param   title  - Title that will be displayed before the value
    372           *          value  - value
    373           *          format - redix
    374           *          line   - line number
    375           *
    376           * @return  None
    377           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    378          void HalLcdWriteStringValue( char *title, uint16 value, uint8 format, uint8 line )
   \                     HalLcdWriteStringValue:
    379          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7427         MOV     A,#0x27
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 5,A
    380          #if (HAL_LCD == TRUE)
    381            uint8 tmpLen;
    382            uint8 buf[LCD_MAX_BUF];
    383            uint32 err;
    384          
    385            tmpLen = (uint8)osal_strlen( (char*)title );
   \   00001C                ; Setup parameters for call to function osal_strlen
   \   00001C   12....       LCALL   ??osal_strlen?relay
    386            osal_memcpy( buf, title, tmpLen );
   \   00001F                ; Setup parameters for call to function osal_memcpy
   \   00001F   75..00       MOV     ?V0 + 2,#0x0
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000027   EA           MOV     A,R2
   \   000028   F5..         MOV     ?V0 + 0,A
   \   00002A   FC           MOV     R4,A
   \   00002B   7D00         MOV     R5,#0x0
   \   00002D   7403         MOV     A,#0x3
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   AA82         MOV     R2,DPL
   \   000034   AB83         MOV     R3,DPH
   \   000036   12....       LCALL   ??osal_memcpy?relay
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
    387            buf[tmpLen] = ' ';
   \   00003E   85..82       MOV     DPL,?XSP + 0
   \   000041   85..83       MOV     DPH,?XSP + 1
   \   000044   E582         MOV     A,DPL
   \   000046   25..         ADD     A,?V0 + 0
   \   000048   F582         MOV     DPL,A
   \   00004A   E583         MOV     A,DPH
   \   00004C   3400         ADDC    A,#0x0
   \   00004E   F583         MOV     DPH,A
   \   000050   7420         MOV     A,#0x20
   \   000052   F0           MOVX    @DPTR,A
    388            err = (uint32)(value);
    389            _ltoa( err, &buf[tmpLen+1], format );
   \   000053                ; Setup parameters for call to function _ltoa
   \   000053   A3           INC     DPTR
   \   000054   8582..       MOV     ?V0 + 0,DPL
   \   000057   8583..       MOV     ?V0 + 1,DPH
   \   00005A   78..         MOV     R0,#?V0 + 0
   \   00005C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005F   A9..         MOV     R1,?V0 + 3
   \   000061   8E..         MOV     ?V0 + 0,R6
   \   000063   8F..         MOV     ?V0 + 1,R7
   \   000065   AA..         MOV     R2,?V0 + 0
   \   000067   AB..         MOV     R3,?V0 + 1
   \   000069   7C00         MOV     R4,#0x0
   \   00006B   7D00         MOV     R5,#0x0
   \   00006D   12....       LCALL   ??_ltoa?relay
   \   000070   7402         MOV     A,#0x2
   \   000072   12....       LCALL   ?DEALLOC_XSTACK8
    390            HalLcdWriteString( (char*)buf, line );		
   \   000075                ; Setup parameters for call to function HalLcdWriteString
   \   000075   A9..         MOV     R1,?V0 + 5
   \   000077   85..82       MOV     DPL,?XSP + 0
   \   00007A   85..83       MOV     DPH,?XSP + 1
   \   00007D   AA82         MOV     R2,DPL
   \   00007F   AB83         MOV     R3,DPH
   \   000081   12....       LCALL   ??HalLcdWriteString?relay
    391          #endif
    392          }
   \   000084   7419         MOV     A,#0x19
   \   000086   12....       LCALL   ?DEALLOC_XSTACK8
   \   000089   7F06         MOV     R7,#0x6
   \   00008B   02....       LJMP    ?BANKED_LEAVE_XDATA
    393          
    394          /**************************************************************************************************
    395           * @fn      HalLcdWriteStringValue
    396           *
    397           * @brief   Write a string followed by a value to the LCD
    398           *
    399           * @param   title   - Title that will be displayed before the value
    400           *          value1  - value #1
    401           *          format1 - redix of value #1
    402           *          value2  - value #2
    403           *          format2 - redix of value #2
    404           *          line    - line number
    405           *
    406           * @return  None
    407           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    408          void HalLcdWriteStringValueValue( char *title, uint16 value1, uint8 format1,
   \                     HalLcdWriteStringValueValue:
    409                                            uint16 value2, uint8 format2, uint8 line )
    410          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7429         MOV     A,#0x29
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 6,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 7,A
    411          
    412          #if (HAL_LCD == TRUE)
    413          
    414            uint8 tmpLen;
    415            uint8 buf[LCD_MAX_BUF];
    416            uint32 err;
    417          
    418            tmpLen = (uint8)osal_strlen( (char*)title );
   \   000020                ; Setup parameters for call to function osal_strlen
   \   000020   12....       LCALL   ??osal_strlen?relay
   \   000023   EA           MOV     A,R2
   \   000024   F5..         MOV     ?V0 + 4,A
    419            if ( tmpLen )
   \   000026   603A         JZ      ??HalLcdWriteStringValueValue_0
    420            {
    421              osal_memcpy( buf, title, tmpLen );
   \   000028                ; Setup parameters for call to function osal_memcpy
   \   000028   75..00       MOV     ?V0 + 2,#0x0
   \   00002B   78..         MOV     R0,#?V0 + 0
   \   00002D   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000030   EA           MOV     A,R2
   \   000031   F5..         MOV     ?V0 + 0,A
   \   000033   FC           MOV     R4,A
   \   000034   7D00         MOV     R5,#0x0
   \   000036   7403         MOV     A,#0x3
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   AA82         MOV     R2,DPL
   \   00003D   AB83         MOV     R3,DPH
   \   00003F   12....       LCALL   ??osal_memcpy?relay
   \   000042   7403         MOV     A,#0x3
   \   000044   12....       LCALL   ?DEALLOC_XSTACK8
    422              buf[tmpLen++] = ' ';
   \   000047   7420         MOV     A,#0x20
   \   000049   C0E0         PUSH    A
   \   00004B   85..82       MOV     DPL,?XSP + 0
   \   00004E   85..83       MOV     DPH,?XSP + 1
   \   000051   E582         MOV     A,DPL
   \   000053   25..         ADD     A,?V0 + 0
   \   000055   F582         MOV     DPL,A
   \   000057   E583         MOV     A,DPH
   \   000059   3400         ADDC    A,#0x0
   \   00005B   F583         MOV     DPH,A
   \   00005D   D0E0         POP     A
   \   00005F   F0           MOVX    @DPTR,A
   \   000060   05..         INC     ?V0 + 4
    423            }
    424          
    425            err = (uint32)(value1);
    426            _ltoa( err, &buf[tmpLen], format1 );
   \                     ??HalLcdWriteStringValueValue_0:
   \   000062                ; Setup parameters for call to function _ltoa
   \   000062   85..82       MOV     DPL,?XSP + 0
   \   000065   85..83       MOV     DPH,?XSP + 1
   \   000068   E582         MOV     A,DPL
   \   00006A   25..         ADD     A,?V0 + 4
   \   00006C   F5..         MOV     ?V0 + 0,A
   \   00006E   E583         MOV     A,DPH
   \   000070   3400         ADDC    A,#0x0
   \   000072   F5..         MOV     ?V0 + 1,A
   \   000074   78..         MOV     R0,#?V0 + 0
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   A9..         MOV     R1,?V0 + 3
   \   00007B   8E..         MOV     ?V0 + 0,R6
   \   00007D   8F..         MOV     ?V0 + 1,R7
   \   00007F   AA..         MOV     R2,?V0 + 0
   \   000081   AB..         MOV     R3,?V0 + 1
   \   000083   7C00         MOV     R4,#0x0
   \   000085   7D00         MOV     R5,#0x0
   \   000087   12....       LCALL   ??_ltoa?relay
   \   00008A   7402         MOV     A,#0x2
   \   00008C   12....       LCALL   ?DEALLOC_XSTACK8
    427            tmpLen = (uint8)osal_strlen( (char*)buf );
   \   00008F                ; Setup parameters for call to function osal_strlen
   \   00008F   85..82       MOV     DPL,?XSP + 0
   \   000092   85..83       MOV     DPH,?XSP + 1
   \   000095   AA82         MOV     R2,DPL
   \   000097   AB83         MOV     R3,DPH
   \   000099   12....       LCALL   ??osal_strlen?relay
   \   00009C   EA           MOV     A,R2
   \   00009D   F5..         MOV     ?V0 + 4,A
    428          
    429            buf[tmpLen++] = ',';
   \   00009F   742C         MOV     A,#0x2c
   \   0000A1   C0E0         PUSH    A
   \   0000A3   8A..         MOV     ?V0 + 0,R2
   \   0000A5   85..82       MOV     DPL,?XSP + 0
   \   0000A8   85..83       MOV     DPH,?XSP + 1
   \   0000AB   E582         MOV     A,DPL
   \   0000AD   25..         ADD     A,?V0 + 0
   \   0000AF   F582         MOV     DPL,A
   \   0000B1   E583         MOV     A,DPH
   \   0000B3   3400         ADDC    A,#0x0
   \   0000B5   F583         MOV     DPH,A
   \   0000B7   D0E0         POP     A
   \   0000B9   F0           MOVX    @DPTR,A
   \   0000BA   05..         INC     ?V0 + 4
    430            buf[tmpLen++] = ' ';
   \   0000BC   7420         MOV     A,#0x20
   \   0000BE   C0E0         PUSH    A
   \   0000C0   85....       MOV     ?V0 + 0,?V0 + 4
   \   0000C3   85..82       MOV     DPL,?XSP + 0
   \   0000C6   85..83       MOV     DPH,?XSP + 1
   \   0000C9   E582         MOV     A,DPL
   \   0000CB   25..         ADD     A,?V0 + 0
   \   0000CD   F582         MOV     DPL,A
   \   0000CF   E583         MOV     A,DPH
   \   0000D1   3400         ADDC    A,#0x0
   \   0000D3   F583         MOV     DPH,A
   \   0000D5   D0E0         POP     A
   \   0000D7   F0           MOVX    @DPTR,A
    431            err = (uint32)(value2);
    432            _ltoa( err, &buf[tmpLen], format2 );
   \   0000D8                ; Setup parameters for call to function _ltoa
   \   0000D8   7401         MOV     A,#0x1
   \   0000DA   25..         ADD     A,?V0 + 4
   \   0000DC   F8           MOV     R0,A
   \   0000DD   85..82       MOV     DPL,?XSP + 0
   \   0000E0   85..83       MOV     DPH,?XSP + 1
   \   0000E3   E582         MOV     A,DPL
   \   0000E5   28           ADD     A,R0
   \   0000E6   F5..         MOV     ?V0 + 0,A
   \   0000E8   E583         MOV     A,DPH
   \   0000EA   3400         ADDC    A,#0x0
   \   0000EC   F5..         MOV     ?V0 + 1,A
   \   0000EE   78..         MOV     R0,#?V0 + 0
   \   0000F0   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000F3   742D         MOV     A,#0x2d
   \   0000F5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F8   E0           MOVX    A,@DPTR
   \   0000F9   F9           MOV     R1,A
   \   0000FA   AA..         MOV     R2,?V0 + 6
   \   0000FC   AB..         MOV     R3,?V0 + 7
   \   0000FE   7C00         MOV     R4,#0x0
   \   000100   7D00         MOV     R5,#0x0
   \   000102   12....       LCALL   ??_ltoa?relay
   \   000105   7402         MOV     A,#0x2
   \   000107   12....       LCALL   ?DEALLOC_XSTACK8
    433          
    434            HalLcdWriteString( (char *)buf, line );		
   \   00010A                ; Setup parameters for call to function HalLcdWriteString
   \   00010A   742C         MOV     A,#0x2c
   \   00010C   12....       LCALL   ?XSTACK_DISP0_8
   \   00010F   E0           MOVX    A,@DPTR
   \   000110   F9           MOV     R1,A
   \   000111   85..82       MOV     DPL,?XSP + 0
   \   000114   85..83       MOV     DPH,?XSP + 1
   \   000117   AA82         MOV     R2,DPL
   \   000119   AB83         MOV     R3,DPH
   \   00011B   12....       LCALL   ??HalLcdWriteString?relay
    435          
    436          #endif
    437          }
   \   00011E   7419         MOV     A,#0x19
   \   000120   12....       LCALL   ?DEALLOC_XSTACK8
   \   000123   7F08         MOV     R7,#0x8
   \   000125   02....       LJMP    ?BANKED_LEAVE_XDATA
    438          
    439          /**************************************************************************************************
    440           * @fn      HalLcdDisplayPercentBar
    441           *
    442           * @brief   Display percentage bar on the LCD
    443           *
    444           * @param   title   -
    445           *          value   -
    446           *
    447           * @return  None
    448           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    449          void HalLcdDisplayPercentBar( char *title, uint8 value )
   \                     HalLcdDisplayPercentBar:
    450          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    451          #if (HAL_LCD == TRUE)
    452          
    453            uint8 percent;
    454            uint8 leftOver;
    455            uint8 buf[17];
    456            uint32 err;
    457            uint8 x;
    458          
    459            /* Write the title: */
    460            HalLcdWriteString( title, HAL_LCD_LINE_1 );
   \   00000C                ; Setup parameters for call to function HalLcdWriteString
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   12....       LCALL   ??HalLcdWriteString?relay
    461          
    462            if ( value > 100 )
   \   000011   EE           MOV     A,R6
   \   000012   C3           CLR     C
   \   000013   9465         SUBB    A,#0x65
   \   000015   4002         JC      ??HalLcdDisplayPercentBar_0
    463              value = 100;
   \   000017   7E64         MOV     R6,#0x64
    464          
    465            /* convert to blocks */
    466            percent = (uint8)(value / 10);
   \                     ??HalLcdDisplayPercentBar_0:
   \   000019   75F00A       MOV     B,#0xa
   \   00001C   EE           MOV     A,R6
   \   00001D   84           DIV     AB
   \   00001E   F5..         MOV     ?V0 + 3,A
    467            leftOver = (uint8)(value % 10);
   \   000020   EE           MOV     A,R6
   \   000021   75F00A       MOV     B,#0xa
   \   000024   84           DIV     AB
   \   000025   AFF0         MOV     R7,B
    468          
    469            /* Make window */
    470            osal_memcpy( buf, "[          ]  ", 15 );
   \   000027                ; Setup parameters for call to function osal_memcpy
   \   000027   75....       MOV     ?V0 + 0,#(`?<Constant "[          ]  ">` & 0xff)
   \   00002A   75....       MOV     ?V0 + 1,#((`?<Constant "[          ]  ">` >> 8) & 0xff)
   \   00002D   75..00       MOV     ?V0 + 2,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000035   7C0F         MOV     R4,#0xf
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   AA82         MOV     R2,DPL
   \   000040   AB83         MOV     R3,DPH
   \   000042   12....       LCALL   ??osal_memcpy?relay
   \   000045   7403         MOV     A,#0x3
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
    471          
    472            for ( x = 0; x < percent; x ++ )
   \   00004A   801F         SJMP    ??HalLcdDisplayPercentBar_1
    473            {
    474              buf[1+x] = '>';
   \                     ??HalLcdDisplayPercentBar_2:
   \   00004C   743E         MOV     A,#0x3e
   \   00004E   C0E0         PUSH    A
   \   000050   85....       MOV     ?V0 + 0,?V0 + 2
   \   000053   85..82       MOV     DPL,?XSP + 0
   \   000056   85..83       MOV     DPH,?XSP + 1
   \   000059   E582         MOV     A,DPL
   \   00005B   25..         ADD     A,?V0 + 0
   \   00005D   F582         MOV     DPL,A
   \   00005F   E583         MOV     A,DPH
   \   000061   3400         ADDC    A,#0x0
   \   000063   F583         MOV     DPH,A
   \   000065   A3           INC     DPTR
   \   000066   D0E0         POP     A
   \   000068   F0           MOVX    @DPTR,A
    475            }
   \   000069   05..         INC     ?V0 + 2
   \                     ??HalLcdDisplayPercentBar_1:
   \   00006B   E5..         MOV     A,?V0 + 2
   \   00006D   C3           CLR     C
   \   00006E   95..         SUBB    A,?V0 + 3
   \   000070   40DA         JC      ??HalLcdDisplayPercentBar_2
    476          
    477            if ( leftOver >= 5 )
   \   000072   EF           MOV     A,R7
   \   000073   C3           CLR     C
   \   000074   9405         SUBB    A,#0x5
   \   000076   401A         JC      ??HalLcdDisplayPercentBar_3
    478              buf[1+x] = '+';
   \   000078   742B         MOV     A,#0x2b
   \   00007A   C0E0         PUSH    A
   \   00007C   85..82       MOV     DPL,?XSP + 0
   \   00007F   85..83       MOV     DPH,?XSP + 1
   \   000082   E582         MOV     A,DPL
   \   000084   25..         ADD     A,?V0 + 2
   \   000086   F582         MOV     DPL,A
   \   000088   E583         MOV     A,DPH
   \   00008A   3400         ADDC    A,#0x0
   \   00008C   F583         MOV     DPH,A
   \   00008E   A3           INC     DPTR
   \   00008F   D0E0         POP     A
   \   000091   F0           MOVX    @DPTR,A
    479          
    480            err = (uint32)value;
    481            _ltoa( err, (uint8*)&buf[13], 10 );
   \                     ??HalLcdDisplayPercentBar_3:
   \   000092                ; Setup parameters for call to function _ltoa
   \   000092   740D         MOV     A,#0xd
   \   000094   12....       LCALL   ?XSTACK_DISP0_8
   \   000097   8582..       MOV     ?V0 + 0,DPL
   \   00009A   8583..       MOV     ?V0 + 1,DPH
   \   00009D   78..         MOV     R0,#?V0 + 0
   \   00009F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A2   790A         MOV     R1,#0xa
   \   0000A4   EE           MOV     A,R6
   \   0000A5   FA           MOV     R2,A
   \   0000A6   7B00         MOV     R3,#0x0
   \   0000A8   7C00         MOV     R4,#0x0
   \   0000AA   7D00         MOV     R5,#0x0
   \   0000AC   12....       LCALL   ??_ltoa?relay
   \   0000AF   7402         MOV     A,#0x2
   \   0000B1   12....       LCALL   ?DEALLOC_XSTACK8
    482          
    483            HalLcdWriteString( (char*)buf, HAL_LCD_LINE_2 );
   \   0000B4                ; Setup parameters for call to function HalLcdWriteString
   \   0000B4   7902         MOV     R1,#0x2
   \   0000B6   85..82       MOV     DPL,?XSP + 0
   \   0000B9   85..83       MOV     DPH,?XSP + 1
   \   0000BC   AA82         MOV     R2,DPL
   \   0000BE   AB83         MOV     R3,DPH
   \   0000C0   12....       LCALL   ??HalLcdWriteString?relay
    484          
    485          #endif
    486          
    487          }
   \   0000C3   7411         MOV     A,#0x11
   \   0000C5   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000C8   7F04         MOV     R7,#0x4
   \   0000CA   02....       LJMP    ?BANKED_LEAVE_XDATA
    488          
    489          
    490          #if (HAL_LCD == TRUE)
    491          /**************************************************************************************************
    492           *                                    HARDWARE LCD
    493           **************************************************************************************************/
    494          
    495          /**************************************************************************************************
    496           * @fn      halLcd_ConfigIO
    497           *
    498           * @brief   Configure IO lines needed for LCD control.
    499           *
    500           * @param   None
    501           *
    502           * @return  None
    503           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    504          static void halLcd_ConfigIO(void)
   \                     halLcd_ConfigIO:
    505          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    506            /* GPIO configuration */
    507            HAL_CONFIG_IO_OUTPUT(HAL_LCD_MODE_PORT,  HAL_LCD_MODE_PIN,  1);
   \   000000   53F3FE       ANL     0xf3,#0xfe
   \   000003   D280         SETB    0x80.0
   \   000005   43FD01       ORL     0xfd,#0x1
    508            HAL_CONFIG_IO_OUTPUT(HAL_LCD_RESET_PORT, HAL_LCD_RESET_PIN, 1);
   \   000008   53F4FD       ANL     0xf4,#0xfd
   \   00000B   D291         SETB    0x90.1
   \   00000D   43FE02       ORL     0xfe,#0x2
    509            HAL_CONFIG_IO_OUTPUT(HAL_LCD_CS_PORT,    HAL_LCD_CS_PIN,    1);
   \   000010   53F4FB       ANL     0xf4,#0xfb
   \   000013   D292         SETB    0x90.2
   \   000015   43FE04       ORL     0xfe,#0x4
    510          }
   \   000018   02....       LJMP    ?BRET
   \   00001B                REQUIRE _A_P0
   \   00001B                REQUIRE _A_P1
   \   00001B                REQUIRE P0SEL
   \   00001B                REQUIRE P1SEL
   \   00001B                REQUIRE P0DIR
   \   00001B                REQUIRE P1DIR
    511          
    512          /**************************************************************************************************
    513           * @fn      halLcd_ConfigSPI
    514           *
    515           * @brief   Configure SPI lines needed for talking to LCD.
    516           *
    517           * @param   None
    518           *
    519           * @return  None
    520           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    521          static void halLcd_ConfigSPI(void)
   \                     halLcd_ConfigSPI:
    522          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    523            /* UART/SPI Peripheral configuration */
    524          
    525             uint8 baud_exponent;
    526             uint8 baud_mantissa;
    527          
    528            /* Set SPI on UART 1 alternative 2 */
    529            PERCFG |= 0x02;
   \   000000   43F102       ORL     0xf1,#0x2
    530          
    531            /* Configure clk, master out and master in lines */
    532            HAL_CONFIG_IO_PERIPHERAL(HAL_LCD_CLK_PORT,  HAL_LCD_CLK_PIN);
   \   000003   43F420       ORL     0xf4,#0x20
    533            HAL_CONFIG_IO_PERIPHERAL(HAL_LCD_MOSI_PORT, HAL_LCD_MOSI_PIN);
   \   000006   43F440       ORL     0xf4,#0x40
    534            HAL_CONFIG_IO_PERIPHERAL(HAL_LCD_MISO_PORT, HAL_LCD_MISO_PIN);
   \   000009   43F480       ORL     0xf4,#0x80
    535          
    536          
    537            /* Set SPI speed to 1 MHz (the values assume system clk of 32MHz)
    538             * Confirm on board that this results in 1MHz spi clk.
    539             */
    540            baud_exponent = 15;
    541            baud_mantissa =  0;
    542          
    543            /* Configure SPI */
    544            U1UCR  = 0x80;      /* Flush and goto IDLE state. 8-N-1. */
   \   00000C   75FB80       MOV     0xfb,#-0x80
    545            U1CSR  = 0x00;      /* SPI mode, master. */
   \   00000F   75F800       MOV     0xf8,#0x0
    546            U1GCR  = HAL_SPI_TRANSFER_MSB_FIRST | HAL_SPI_CLOCK_PHA_0 | HAL_SPI_CLOCK_POL_LO | baud_exponent;
   \   000012   75FC2F       MOV     0xfc,#0x2f
    547            U1BAUD = baud_mantissa;
   \   000015   75FA00       MOV     0xfa,#0x0
    548          }
   \   000018   02....       LJMP    ?BRET
   \   00001B                REQUIRE PERCFG
   \   00001B                REQUIRE P1SEL
   \   00001B                REQUIRE _A_U1CSR
   \   00001B                REQUIRE U1BAUD
   \   00001B                REQUIRE U1UCR
   \   00001B                REQUIRE U1GCR
    549          
    550          /**************************************************************************************************
    551           * @fn      HalLcd_HW_Init
    552           *
    553           * @brief   Initilize HW LCD Driver.
    554           *
    555           * @param   None
    556           *
    557           * @return  None
    558           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    559          void HalLcd_HW_Init(void)
   \                     HalLcd_HW_Init:
    560          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    561            /* Initialize LCD IO lines */
    562            halLcd_ConfigIO();
   \   000004                ; Setup parameters for call to function halLcd_ConfigIO
   \   000004   12....       LCALL   ??halLcd_ConfigIO?relay
    563          
    564            /* Initialize SPI */
    565            halLcd_ConfigSPI();
   \   000007                ; Setup parameters for call to function halLcd_ConfigSPI
   \   000007   12....       LCALL   ??halLcd_ConfigSPI?relay
    566          
    567            /* Perform reset */
    568            LCD_ACTIVATE_RESET();
   \   00000A   C291         CLR     0x90.1
    569            HalLcd_HW_WaitUs(15000); // 15 ms
   \   00000C                ; Setup parameters for call to function HalLcd_HW_WaitUs
   \   00000C   7A98         MOV     R2,#-0x68
   \   00000E   7B3A         MOV     R3,#0x3a
   \   000010   12....       LCALL   ??HalLcd_HW_WaitUs?relay
    570            LCD_RELEASE_RESET();
   \   000013   D291         SETB    0x90.1
    571            HalLcd_HW_WaitUs(15); // 15 us
   \   000015                ; Setup parameters for call to function HalLcd_HW_WaitUs
   \   000015   7A0F         MOV     R2,#0xf
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   ??HalLcd_HW_WaitUs?relay
    572          
    573            /* Perform the initialization sequence */
    574            FUNCTION_SET(CGRAM | COM_FORWARD | THREE_LINE);
   \   00001C                ; Setup parameters for call to function HalLcd_HW_Control
   \   00001C   7915         MOV     R1,#0x15
   \   00001E   12....       LCALL   ??HalLcd_HW_Control?relay
    575          
    576            /* Set contrast */
    577            HalLcd_HW_SetContrast(15);
   \   000021                ; Setup parameters for call to function HalLcd_HW_SetContrast
   \   000021   790F         MOV     R1,#0xf
   \   000023   12....       LCALL   ??HalLcd_HW_SetContrast?relay
    578          
    579            /* Set power */
    580            SET_POWER_SAVE_MODE(OSC_OFF | POWER_SAVE_ON);
   \   000026                ; Setup parameters for call to function HalLcd_HW_Control
   \   000026   790E         MOV     R1,#0xe
   \   000028   12....       LCALL   ??HalLcd_HW_Control?relay
    581            SET_POWER_CTRL(VOLTAGE_DIVIDER_ON | CONVERTER_AND_REG_ON);
   \   00002B                ; Setup parameters for call to function HalLcd_HW_Control
   \   00002B   7925         MOV     R1,#0x25
   \   00002D   12....       LCALL   ??HalLcd_HW_Control?relay
    582            SET_BIAS_CTRL(BIAS_1_5);
   \   000030                ; Setup parameters for call to function HalLcd_HW_Control
   \   000030   791C         MOV     R1,#0x1c
   \   000032   12....       LCALL   ??HalLcd_HW_Control?relay
    583            HalLcd_HW_WaitUs(21000);// 21 ms
   \   000035                ; Setup parameters for call to function HalLcd_HW_WaitUs
   \   000035   7A08         MOV     R2,#0x8
   \   000037   7B52         MOV     R3,#0x52
   \   000039   12....       LCALL   ??HalLcd_HW_WaitUs?relay
    584          
    585            /* Clear the display */
    586            HalLcd_HW_Clear();
   \   00003C                ; Setup parameters for call to function HalLcd_HW_Clear
   \   00003C   12....       LCALL   ??HalLcd_HW_Clear?relay
    587            HalLcd_HW_ClearAllSpecChars();
   \   00003F                ; Setup parameters for call to function HalLcd_HW_ClearAllSpecChars
   \   00003F   12....       LCALL   ??HalLcd_HW_ClearAllSpecChars?relay
    588            SET_DISPLAY_CTRL(DISPLAY_CTRL_ON | DISPLAY_CTRL_BLINK_OFF | DISPLAY_CTRL_CURSOR_OFF);
   \   000042                ; Setup parameters for call to function HalLcd_HW_Control
   \   000042   7929         MOV     R1,#0x29
   \   000044   12....       LCALL   ??HalLcd_HW_Control?relay
    589          }
   \   000047   D083         POP     DPH
   \   000049   D082         POP     DPL
   \   00004B   02....       LJMP    ?BRET
   \   00004E                REQUIRE _A_P1
    590          
    591          /**************************************************************************************************
    592           * @fn      HalLcd_HW_Control
    593           *
    594           * @brief   Write 1 command to the LCD
    595           *
    596           * @param   uint8 cmd - command to be written to the LCD
    597           *
    598           * @return  None
    599           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    600          void HalLcd_HW_Control(uint8 cmd)
   \                     HalLcd_HW_Control:
    601          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    602            LCD_SPI_BEGIN();
   \   000000   C292         CLR     0x90.2
    603            LCD_DO_CONTROL();
   \   000002   C280         CLR     0x80.0
    604            LCD_SPI_TX(cmd);
   \   000004   53F8F9       ANL     0xf8,#0xf9
   \   000007   E5F8         MOV     A,0xf8
   \   000009   89F9         MOV     0xf9,R1
   \                     ??HalLcd_HW_Control_0:
   \   00000B   A2F9         MOV     C,0xf8.1
   \   00000D   50FC         JNC     ??HalLcd_HW_Control_0
    605            LCD_SPI_WAIT_RXRDY();
   \                     ??HalLcd_HW_Control_1:
   \   00000F   A2F9         MOV     C,0xf8.1
   \   000011   50FC         JNC     ??HalLcd_HW_Control_1
    606            LCD_SPI_END();
   \   000013   00           NOP
   \   000014   00           NOP
   \   000015   00           NOP
   \   000016   00           NOP
   \   000017   D292         SETB    0x90.2
    607          }
   \   000019   02....       LJMP    ?BRET
   \   00001C                REQUIRE _A_P0
   \   00001C                REQUIRE _A_P1
   \   00001C                REQUIRE _A_U1CSR
   \   00001C                REQUIRE U1DBUF
    608          
    609          /**************************************************************************************************
    610           * @fn      HalLcd_HW_Write
    611           *
    612           * @brief   Write 1 byte to the LCD
    613           *
    614           * @param   uint8 data - data to be written to the LCD
    615           *
    616           * @return  None
    617           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    618          void HalLcd_HW_Write(uint8 data)
   \                     HalLcd_HW_Write:
    619          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    620            LCD_SPI_BEGIN();
   \   000000   C292         CLR     0x90.2
    621            LCD_DO_WRITE();
   \   000002   D280         SETB    0x80.0
    622            LCD_SPI_TX(data);
   \   000004   53F8F9       ANL     0xf8,#0xf9
   \   000007   E5F8         MOV     A,0xf8
   \   000009   89F9         MOV     0xf9,R1
   \                     ??HalLcd_HW_Write_0:
   \   00000B   A2F9         MOV     C,0xf8.1
   \   00000D   50FC         JNC     ??HalLcd_HW_Write_0
    623            LCD_SPI_WAIT_RXRDY();
   \                     ??HalLcd_HW_Write_1:
   \   00000F   A2F9         MOV     C,0xf8.1
   \   000011   50FC         JNC     ??HalLcd_HW_Write_1
    624            LCD_SPI_END();
   \   000013   00           NOP
   \   000014   00           NOP
   \   000015   00           NOP
   \   000016   00           NOP
   \   000017   D292         SETB    0x90.2
    625          }
   \   000019   02....       LJMP    ?BRET
   \   00001C                REQUIRE _A_P0
   \   00001C                REQUIRE _A_P1
   \   00001C                REQUIRE _A_U1CSR
   \   00001C                REQUIRE U1DBUF
    626          
    627          /**************************************************************************************************
    628           * @fn          HalLcd_HW_SetContrast
    629           *
    630           * @brief       Set display contrast
    631           *
    632           * @param       uint8 value - contrast value
    633           *
    634           * @return      none
    635           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    636          void HalLcd_HW_SetContrast(uint8 value)
   \                     HalLcd_HW_SetContrast:
    637          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    638            SET_ICONRAM_ADDR(CONTRAST_CTRL_REGISTER);
   \   000007                ; Setup parameters for call to function HalLcd_HW_Control
   \   000007   7950         MOV     R1,#0x50
   \   000009   12....       LCALL   ??HalLcd_HW_Control?relay
    639            HalLcd_HW_Write(value);
   \   00000C                ; Setup parameters for call to function HalLcd_HW_Write
   \   00000C   EE           MOV     A,R6
   \   00000D   F9           MOV     R1,A
   \   00000E   12....       LCALL   ??HalLcd_HW_Write?relay
    640          }
   \   000011   7F01         MOV     R7,#0x1
   \   000013   02....       LJMP    ?BANKED_LEAVE_XDATA
    641          
    642          /**************************************************************************************************
    643           * @fn      HalLcd_HW_Clear
    644           *
    645           * @brief   Clear the HW LCD
    646           *
    647           * @param   None
    648           *
    649           * @return  None
    650           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    651          void HalLcd_HW_Clear(void)
   \                     HalLcd_HW_Clear:
    652          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    653            uint8 n;
    654          
    655            SET_DDRAM_ADDR(0x00);
   \   000005                ; Setup parameters for call to function HalLcd_HW_Control
   \   000005   7980         MOV     R1,#-0x80
   \   000007   12....       LCALL   ??HalLcd_HW_Control?relay
    656            for (n = 0; n < (LCD_MAX_LINE_COUNT * LCD_MAX_LINE_LENGTH); n++)
   \   00000A   7E00         MOV     R6,#0x0
   \   00000C   8006         SJMP    ??HalLcd_HW_Clear_0
    657            {
    658              HalLcd_HW_Write(' ');
   \                     ??HalLcd_HW_Clear_1:
   \   00000E                ; Setup parameters for call to function HalLcd_HW_Write
   \   00000E   7920         MOV     R1,#0x20
   \   000010   12....       LCALL   ??HalLcd_HW_Write?relay
    659            }
   \   000013   0E           INC     R6
   \                     ??HalLcd_HW_Clear_0:
   \   000014   EE           MOV     A,R6
   \   000015   C3           CLR     C
   \   000016   9430         SUBB    A,#0x30
   \   000018   40F4         JC      ??HalLcd_HW_Clear_1
    660          }
   \   00001A   7F01         MOV     R7,#0x1
   \   00001C   02....       LJMP    ?BANKED_LEAVE_XDATA
    661          
    662          /**************************************************************************************************
    663           * @fn      HalLcd_HW_ClearAllSpecChars
    664           *
    665           * @brief   Clear all special chars
    666           *
    667           * @param   None
    668           *
    669           * @return  None
    670           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    671          void HalLcd_HW_ClearAllSpecChars(void)
   \                     HalLcd_HW_ClearAllSpecChars:
    672          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    673            uint8 n = 0;
    674          
    675            SET_GCRAM_CHAR(0);
   \   000005                ; Setup parameters for call to function HalLcd_HW_Control
   \   000005   79C0         MOV     R1,#-0x40
   \   000007   12....       LCALL   ??HalLcd_HW_Control?relay
    676            for (n = 0; n < (8 * 8); n++)
   \   00000A   7E00         MOV     R6,#0x0
   \   00000C   8006         SJMP    ??HalLcd_HW_ClearAllSpecChars_0
    677            {
    678              HalLcd_HW_Write(0x00);
   \                     ??HalLcd_HW_ClearAllSpecChars_1:
   \   00000E                ; Setup parameters for call to function HalLcd_HW_Write
   \   00000E   7900         MOV     R1,#0x0
   \   000010   12....       LCALL   ??HalLcd_HW_Write?relay
    679            }
   \   000013   0E           INC     R6
   \                     ??HalLcd_HW_ClearAllSpecChars_0:
   \   000014   EE           MOV     A,R6
   \   000015   C3           CLR     C
   \   000016   9440         SUBB    A,#0x40
   \   000018   40F4         JC      ??HalLcd_HW_ClearAllSpecChars_1
    680          }
   \   00001A   7F01         MOV     R7,#0x1
   \   00001C   02....       LJMP    ?BANKED_LEAVE_XDATA
    681          
    682          /**************************************************************************************************
    683           * @fn      HalLcd_HW_WriteChar
    684           *
    685           * @brief   Write one char to the display
    686           *
    687           * @param   uint8 line - line number that the char will be displayed
    688           *          uint8 col - colum where the char will be displayed
    689           *
    690           * @return  None
    691           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    692          void HalLcd_HW_WriteChar(uint8 line, uint8 col, char text)
   \                     HalLcd_HW_WriteChar:
    693          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EB           MOV     A,R3
   \   000006   FE           MOV     R6,A
    694            if (col < LCD_MAX_LINE_LENGTH)
   \   000007   EA           MOV     A,R2
   \   000008   C3           CLR     C
   \   000009   9410         SUBB    A,#0x10
   \   00000B   5012         JNC     ??HalLcd_HW_WriteChar_0
    695            {
    696              SET_DDRAM_ADDR((line - 1) * LCD_MAX_LINE_LENGTH + col);
   \   00000D                ; Setup parameters for call to function HalLcd_HW_Control
   \   00000D   74FF         MOV     A,#-0x1
   \   00000F   29           ADD     A,R1
   \   000010   C4           SWAP    A
   \   000011   54F0         ANL     A,#0xf0
   \   000013   2A           ADD     A,R2
   \   000014   4480         ORL     A,#0x80
   \   000016   F9           MOV     R1,A
   \   000017   12....       LCALL   ??HalLcd_HW_Control?relay
    697              HalLcd_HW_Write(text);
   \   00001A                ; Setup parameters for call to function HalLcd_HW_Write
   \   00001A   EE           MOV     A,R6
   \   00001B   F9           MOV     R1,A
   \   00001C   12....       LCALL   ??HalLcd_HW_Write?relay
    698            }
    699            else
    700            {
    701              return;
    702            }
    703          }
   \                     ??HalLcd_HW_WriteChar_0:
   \   00001F   7F01         MOV     R7,#0x1
   \   000021   02....       LJMP    ?BANKED_LEAVE_XDATA
    704          
    705          /**************************************************************************************************
    706           * @fn          halLcdWriteLine
    707           *
    708           * @brief       Write one line on display
    709           *
    710           * @param       uint8 line - display line
    711           *              char *pText - text buffer to write
    712           *
    713           * @return      none
    714           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    715          void HalLcd_HW_WriteLine(uint8 line, const char *pText)
   \                     HalLcd_HW_WriteLine:
    716          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    717            uint8 count;
    718            uint8 totalLength = (uint8)osal_strlen( (char *)pText );
   \   00000B                ; Setup parameters for call to function osal_strlen
   \   00000B   12....       LCALL   ??osal_strlen?relay
   \   00000E   EA           MOV     A,R2
   \   00000F   F5..         MOV     ?V0 + 2,A
    719          
    720            /* Write the content first */
    721            for (count=0; count<totalLength; count++)
   \   000011   75..00       MOV     ?V0 + 0,#0x0
   \   000014   8018         SJMP    ??HalLcd_HW_WriteLine_0
    722            {
    723              HalLcd_HW_WriteChar(line, count, (*(pText++)));
   \                     ??HalLcd_HW_WriteLine_1:
   \   000016                ; Setup parameters for call to function HalLcd_HW_WriteChar
   \   000016   8E82         MOV     DPL,R6
   \   000018   8F83         MOV     DPH,R7
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   FB           MOV     R3,A
   \   00001C   AA..         MOV     R2,?V0 + 0
   \   00001E   A9..         MOV     R1,?V0 + 1
   \   000020   12....       LCALL   ??HalLcd_HW_WriteChar?relay
   \   000023   8E82         MOV     DPL,R6
   \   000025   8F83         MOV     DPH,R7
   \   000027   A3           INC     DPTR
   \   000028   AE82         MOV     R6,DPL
   \   00002A   AF83         MOV     R7,DPH
    724            }
   \   00002C   05..         INC     ?V0 + 0
   \                     ??HalLcd_HW_WriteLine_0:
   \   00002E   E5..         MOV     A,?V0 + 0
   \   000030   C3           CLR     C
   \   000031   95..         SUBB    A,?V0 + 2
   \   000033   40E1         JC      ??HalLcd_HW_WriteLine_1
    725          
    726            /* Write blank spaces to rest of the line */
    727            for(count=totalLength; count<LCD_MAX_LINE_LENGTH;count++)
   \   000035   85....       MOV     ?V0 + 0,?V0 + 2
   \   000038   800B         SJMP    ??HalLcd_HW_WriteLine_2
    728            {
    729              HalLcd_HW_WriteChar(line, count, ' ');
   \                     ??HalLcd_HW_WriteLine_3:
   \   00003A                ; Setup parameters for call to function HalLcd_HW_WriteChar
   \   00003A   7B20         MOV     R3,#0x20
   \   00003C   AA..         MOV     R2,?V0 + 0
   \   00003E   A9..         MOV     R1,?V0 + 1
   \   000040   12....       LCALL   ??HalLcd_HW_WriteChar?relay
    730            }
   \   000043   05..         INC     ?V0 + 0
   \                     ??HalLcd_HW_WriteLine_2:
   \   000045   E5..         MOV     A,?V0 + 0
   \   000047   C3           CLR     C
   \   000048   9410         SUBB    A,#0x10
   \   00004A   40EE         JC      ??HalLcd_HW_WriteLine_3
    731          }
   \   00004C   7F03         MOV     R7,#0x3
   \   00004E   02....       LJMP    ?BANKED_LEAVE_XDATA
    732          
    733          /**************************************************************************************************
    734           * @fn      HalLcd_HW_WaitUs
    735           *
    736           * @brief   wait for x us. @ 32MHz MCU clock it takes 32 "nop"s for 1 us delay.
    737           *
    738           * @param   x us. range[0-65536]
    739           *
    740           * @return  None
    741           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    742          void HalLcd_HW_WaitUs(uint16 microSecs)
   \                     HalLcd_HW_WaitUs:
    743          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   8020         SJMP    ??HalLcd_HW_WaitUs_0
    744            while(microSecs--)
    745            {
    746              /* 32 NOPs == 1 usecs */
    747              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \                     ??HalLcd_HW_WaitUs_1:
   \   000002   00           nop
   \   000003   00           nop
   \   000004   00           nop
   \   000005   00           nop
   \   000006   00           nop
    748              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \   000007   00           nop
   \   000008   00           nop
   \   000009   00           nop
   \   00000A   00           nop
   \   00000B   00           nop
    749              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \   00000C   00           nop
   \   00000D   00           nop
   \   00000E   00           nop
   \   00000F   00           nop
   \   000010   00           nop
    750              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \   000011   00           nop
   \   000012   00           nop
   \   000013   00           nop
   \   000014   00           nop
   \   000015   00           nop
    751              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \   000016   00           nop
   \   000017   00           nop
   \   000018   00           nop
   \   000019   00           nop
   \   00001A   00           nop
    752              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
   \   00001B   00           nop
   \   00001C   00           nop
   \   00001D   00           nop
   \   00001E   00           nop
   \   00001F   00           nop
    753              asm("nop"); asm("nop");
   \   000020   00           nop
   \   000021   00           nop
    754            }
   \                     ??HalLcd_HW_WaitUs_0:
   \   000022   EA           MOV     A,R2
   \   000023   F8           MOV     R0,A
   \   000024   EB           MOV     A,R3
   \   000025   F9           MOV     R1,A
   \   000026   74FF         MOV     A,#-0x1
   \   000028   28           ADD     A,R0
   \   000029   1A           DEC     R2
   \   00002A   74FF         MOV     A,#-0x1
   \   00002C   39           ADDC    A,R1
   \   00002D   FB           MOV     R3,A
   \   00002E   E8           MOV     A,R0
   \   00002F   7001         JNZ     ??HalLcd_HW_WaitUs_2
   \   000031   E9           MOV     A,R1
   \                     ??HalLcd_HW_WaitUs_2:
   \   000032   70CE         JNZ     ??HalLcd_HW_WaitUs_1
    755          }
   \   000034   02....       LJMP    ?BRET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteString?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteString

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteScreen?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteScreen

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValueValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValueValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdDisplayPercentBar?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdDisplayPercentBar

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halLcd_ConfigIO?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halLcd_ConfigIO

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??halLcd_ConfigSPI?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    halLcd_ConfigSPI

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_Control?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_Control

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_Write?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_Write

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_SetContrast?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_SetContrast

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_Clear?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_Clear

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_ClearAllSpecChars?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_ClearAllSpecChars

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_WriteChar?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_WriteChar

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_WriteLine?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_WriteLine

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_WaitUs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_WaitUs

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Texas Instruments">`:
   \   000000   54657861     DB "Texas Instruments"
   \            7320496E
   \            73747275
   \            6D656E74
   \            7300    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "[          ]  ">`:
   \   000000   5B202020     DB "[          ]  "
   \            20202020
   \            2020205D
   \            202000  
    756          #endif
    757          
    758          
    759          /**************************************************************************************************
    760          **************************************************************************************************/
    761          
    762          
    763          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     HalLcdDisplayPercentBar            1      0     32
       -> HalLcdWriteString             0      0     58
       -> osal_memcpy                   0      0     64
       -> _ltoa                         0      0     62
       -> HalLcdWriteString             0      0     58
     HalLcdInit                         2      0      0
       -> HalLcd_HW_Init                4      0      0
     HalLcdWriteScreen                  0      0      9
       -> HalLcdWriteString             0      0     18
       -> HalLcdWriteString             0      0     18
     HalLcdWriteString                  1      0     61
       -> osal_mem_alloc                0      0     34
       -> HalLcdWriteString             0      0     34
       -> osal_strlen                   0      0     34
       -> osal_memcpy                   0      0     40
       -> osal_strlen                   0      0     34
       -> osal_mem_alloc                0      0     34
       -> osal_memcpy                   0      0     40
       -> osal_memcpy                   0      0     40
       -> debug_str                     0      0     34
       -> osal_mem_free                 0      0     34
       -> HalLcd_HW_WriteLine           0      0     34
     HalLcdWriteStringValue             1      0     43
       -> osal_strlen                   0      0     78
       -> osal_memcpy                   0      0     84
       -> _ltoa                         0      0     82
       -> HalLcdWriteString             0      0     78
     HalLcdWriteStringValueValue        1      0     48
       -> osal_strlen                   0      0     82
       -> osal_memcpy                   0      0     88
       -> _ltoa                         0      0     86
       -> osal_strlen                   0      0     82
       -> _ltoa                         0      0     86
       -> HalLcdWriteString             0      0     82
     HalLcdWriteValue                   0      0     42
       -> _ltoa                         0      0     82
       -> HalLcdWriteString             0      0     78
     HalLcd_HW_Clear                    0      0      9
       -> HalLcd_HW_Control             0      0     18
       -> HalLcd_HW_Write               0      0     18
     HalLcd_HW_ClearAllSpecChars        0      0      9
       -> HalLcd_HW_Control             0      0     18
       -> HalLcd_HW_Write               0      0     18
     HalLcd_HW_Control                  0      0      9
     HalLcd_HW_Init                     2      0      0
       -> halLcd_ConfigIO               4      0      0
       -> halLcd_ConfigSPI              4      0      0
       -> HalLcd_HW_WaitUs              4      0      0
       -> HalLcd_HW_WaitUs              4      0      0
       -> HalLcd_HW_Control             4      0      0
       -> HalLcd_HW_SetContrast         4      0      0
       -> HalLcd_HW_Control             4      0      0
       -> HalLcd_HW_Control             4      0      0
       -> HalLcd_HW_Control             4      0      0
       -> HalLcd_HW_WaitUs              4      0      0
       -> HalLcd_HW_Clear               4      0      0
       -> HalLcd_HW_ClearAllSpecChars
                                        4      0      0
       -> HalLcd_HW_Control             4      0      0
     HalLcd_HW_SetContrast              0      0      9
       -> HalLcd_HW_Control             0      0     18
       -> HalLcd_HW_Write               0      0     18
     HalLcd_HW_WaitUs                   0      0      0
     HalLcd_HW_Write                    0      0      9
     HalLcd_HW_WriteChar                0      0     20
       -> HalLcd_HW_Control             0      0     18
       -> HalLcd_HW_Write               0      0     18
     HalLcd_HW_WriteLine                0      0     28
       -> osal_strlen                   0      0     22
       -> HalLcd_HW_WriteChar           0      0     22
       -> HalLcd_HW_WriteChar           0      0     22
     halLcd_ConfigIO                    0      0      0
     halLcd_ConfigSPI                   0      0      0


   Segment part sizes:

     Function/Label                      Bytes
     --------------                      -----
     _A_P0                                  1
     _A_P1                                  1
     PERCFG                                 1
     P0SEL                                  1
     P1SEL                                  1
     _A_U1CSR                               1
     U1DBUF                                 1
     U1BAUD                                 1
     U1UCR                                  1
     U1GCR                                  1
     P0DIR                                  1
     P1DIR                                  1
     Lcd_Line1                              2
     HalLcdInit                            21
     HalLcdWriteString                    353
     HalLcdWriteValue                      67
     HalLcdWriteScreen                     28
     HalLcdWriteStringValue               142
     HalLcdWriteStringValueValue          296
     HalLcdDisplayPercentBar              205
     halLcd_ConfigIO                       27
     halLcd_ConfigSPI                      27
     HalLcd_HW_Init                        78
     HalLcd_HW_Control                     28
     HalLcd_HW_Write                       28
     HalLcd_HW_SetContrast                 22
     HalLcd_HW_Clear                       31
     HalLcd_HW_ClearAllSpecChars           31
     HalLcd_HW_WriteChar                   36
     HalLcd_HW_WriteLine                   81
     HalLcd_HW_WaitUs                      55
     ??HalLcdInit?relay                     6
     ??HalLcdWriteString?relay              6
     ??HalLcdWriteValue?relay               6
     ??HalLcdWriteScreen?relay              6
     ??HalLcdWriteStringValue?relay         6
     ??HalLcdWriteStringValueValue?relay    6
     ??HalLcdDisplayPercentBar?relay        6
     ??halLcd_ConfigIO?relay                6
     ??halLcd_ConfigSPI?relay               6
     ??HalLcd_HW_Init?relay                 6
     ??HalLcd_HW_Control?relay              6
     ??HalLcd_HW_Write?relay                6
     ??HalLcd_HW_SetContrast?relay          6
     ??HalLcd_HW_Clear?relay                6
     ??HalLcd_HW_ClearAllSpecChars?relay    6
     ??HalLcd_HW_WriteChar?relay            6
     ??HalLcd_HW_WriteLine?relay            6
     ??HalLcd_HW_WaitUs?relay               6
     ?<Constant "Texas Instruments">       18
     ?<Constant "[          ]  ">          15

 
 1 556 bytes in segment BANKED_CODE
   108 bytes in segment BANK_RELAYS
    12 bytes in segment SFR_AN
    33 bytes in segment XDATA_ROM_C
     2 bytes in segment XDATA_Z
 
 1 664 bytes of CODE  memory
    33 bytes of CONST memory
     0 bytes of DATA  memory (+ 12 bytes shared)
     2 bytes of XDATA memory

Errors: none
Warnings: none
