###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.51A/W32 for 8051                08/Apr/2013  11:22:17 #
# Copyright 2004-2009 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\ZMain\TI2530DB\OnBoard.c              #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0 #
#                          \Projects\zstack\Samples\WSN_sensors\CC2530DB\..\. #
#                          .\..\Tools\CC2530DB\f8wRouter.cfg" (-DCPU32MHZ     #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DRTR_NWK -DBLINK_LEDS) -f "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wConfig.cfg" (-DSECURE=0                  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\ZMain\TI2530DB\OnBoard.c" -D         #
#                          ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC  #
#                          -D LCD_SUPPORTED=DEBUG -lC "C:\Texas               #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\RouterEB\List\"   #
#                          -lA "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3. #
#                          0\Projects\zstack\Samples\WSN_sensors\CC2530DB\Rou #
#                          terEB\List\" --diag_suppress Pe001,Pa010 -o        #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\WSN_sensors\CC2530DB\RouterE #
#                          B\Obj\" -e --require_prototypes --no_unroll        #
#                          --no_inline --no_tbaa --debug --core=plain         #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 8 -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\" -I "C:\Texas    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\SOURCE\" -I    #
#                          "C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pr #
#                          ojects\zstack\Samples\WSN_sensors\CC2530DB\..\..\. #
#                          .\ZMAIN\TI2530DB\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MT\" -I "C:\Texas                         #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\HAL\TARGET\CC2530EB\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\OSAL\INCLUDE\" -I "C:\Texas               #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\AF\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\NWK\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SEC\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SAPI\" -I "C:\Texas                 #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\SYS\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\STACK\ZDO\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\F8W\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\ZMAC\" -I "C:\Texas                       #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SADDR\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\SERVICES\SDATA\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zst #
#                          ack\Samples\WSN_sensors\CC2530DB\..\..\..\..\..\CO #
#                          MPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\" -I      #
#                          "D:\Program Files\IAR Systems\Embedded Workbench   #
#                          5.3\8051\INC\" -I "D:\Program Files\IAR            #
#                          Systems\Embedded Workbench 5.3\8051\INC\CLIB\" -Om #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\WSN_sensors\CC2530DB\RouterEB #
#                          \List\OnBoard.lst                                  #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Pro #
#                          jects\zstack\Samples\WSN_sensors\CC2530DB\RouterEB #
#                          \Obj\OnBoard.r51                                   #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.2.2-1.3.0\Projects\zstack\ZMain\TI2530DB\OnBoard.c
      1          /**************************************************************************************************
      2            Filename:       OnBoard.c
      3            Revised:        $Date: 2009-07-22 17:29:14 -0700 (Wed, 22 Jul 2009) $
      4            Revision:       $Revision: 20349 $
      5          
      6            Description:    This file contains the UI and control for the
      7                            peripherals on the EVAL development board
      8            Notes:          This file targets the Chipcon CC2530
      9          
     10          
     11            Copyright 2005-2009 Texas Instruments Incorporated. All rights reserved.
     12          
     13            IMPORTANT: Your use of this Software is limited to those specific rights
     14            granted under the terms of a software license agreement between the user
     15            who downloaded the software, his/her employer (which must be your employer)
     16            and Texas Instruments Incorporated (the "License").  You may not use this
     17            Software unless you agree to abide by the terms of the License. The License
     18            limits your use, and you acknowledge, that the Software may not be modified,
     19            copied or distributed unless embedded on a Texas Instruments microcontroller
     20            or used solely and exclusively in conjunction with a Texas Instruments radio
     21            frequency transceiver, which is integrated into your product.  Other than for
     22            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     23            works of, modify, distribute, perform, display or sell this Software and/or
     24            its documentation for any purpose.
     25          
     26            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     27            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     28            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     29            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     30            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     31            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     32            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     33            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     34            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     35            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     36            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     37          
     38            Should you have any questions regarding your right to use this Software,
     39            contact Texas Instruments Incorporated at www.TI.com.
     40          **************************************************************************************************/
     41          
     42          /*********************************************************************
     43           * INCLUDES
     44           */
     45          
     46          #include "ZComDef.h"
     47          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x9d
   \   unsigned char volatile __sfr SLEEPSTA
   \                     SLEEPSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1
     48          #include "OSAL.h"
     49          #include "MT.h"
     50          #include "MT_SYS.h"
     51          #include "DebugTrace.h"
     52          
     53          /* Hal */
     54          #include "hal_lcd.h"
     55          #include "hal_mcu.h"
     56          #include "hal_timer.h"
     57          #include "hal_key.h"
     58          #include "hal_led.h"
     59          
     60          /* Allow access macRandomByte() */
     61          #include "mac_radio_defs.h"
     62          
     63          /*********************************************************************
     64           * MACROS
     65           */
     66          
     67          /*********************************************************************
     68           * CONSTANTS
     69           */
     70          
     71          // Task ID not initialized
     72          #define NO_TASK_ID 0xFF
     73          
     74          // Minimum length RAM "pattern" for Stack check
     75          #define MIN_RAM_INIT 12
     76          
     77          /*********************************************************************
     78           * TYPEDEFS
     79           */
     80          
     81          /*********************************************************************
     82           * GLOBAL VARIABLES
     83           */
     84          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     85          uint8 OnboardKeyIntEnable;
   \                     OnboardKeyIntEnable:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     86          
     87          // 64-bit Extended Address of this device

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     88          uint8 aExtendedAddress[8];
   \                     aExtendedAddress:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
     89          
     90          /*********************************************************************
     91           * EXTERNAL VARIABLES
     92           */
     93          
     94          /*********************************************************************
     95           * EXTERNAL FUNCTIONS
     96           */
     97          
     98          /*********************************************************************
     99           * LOCAL VARIABLES
    100           */
    101          
    102          // Registered keys task ID, initialized to NOT USED.

   \                                 In  segment XDATA_I, align 1, keep-with-next
    103          static uint8 registeredKeysTaskID = NO_TASK_ID;
   \                     registeredKeysTaskID:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for registeredKeysTaskID>`
   \   000001                REQUIRE __INIT_XDATA_I
    104          
    105          /*********************************************************************
    106           * LOCAL FUNCTIONS
    107           */
    108          
    109          static void ChkReset( void );
    110          
    111          /*********************************************************************
    112           * @fn      InitBoard()
    113           * @brief   Initialize the CC2420DB Board Peripherals
    114           * @param   level: COLD,WARM,READY
    115           * @return  None
    116           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    117          void InitBoard( uint8 level )
   \                     InitBoard:
    118          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    119            if ( level == OB_COLD )
   \   000004   E9           MOV     A,R1
   \   000005   7011         JNZ     ??InitBoard_0
    120            {
    121              // Interrupts off
    122              osal_int_disable( INTS_ALL );
   \   000007                ; Setup parameters for call to function osal_int_disable
   \   000007   79FF         MOV     R1,#-0x1
   \   000009   12....       LCALL   ??osal_int_disable?relay
    123              // Turn all LEDs off
    124              HalLedSet( HAL_LED_ALL, HAL_LED_MODE_OFF );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   7A00         MOV     R2,#0x0
   \   00000E   790F         MOV     R1,#0xf
   \   000010   12....       LCALL   ??HalLedSet?relay
    125              // Check for Brown-Out reset
    126              ChkReset();
   \   000013                ; Setup parameters for call to function ChkReset
   \   000013   12....       LCALL   ??ChkReset?relay
   \   000016   8010         SJMP    ??InitBoard_1
    127            }
    128            else  // !OB_COLD
    129            {
    130          #ifdef ZTOOL_PORT
    131              MT_SysResetInd();
   \                     ??InitBoard_0:
   \   000018                ; Setup parameters for call to function MT_SysResetInd
   \   000018   12....       LCALL   ??MT_SysResetInd?relay
    132          #endif
    133          
    134               /* Initialize Key stuff */
    135              OnboardKeyIntEnable = HAL_KEY_INTERRUPT_DISABLE;
   \   00001B   E4           CLR     A
   \   00001C   90....       MOV     DPTR,#OnboardKeyIntEnable
   \   00001F   F0           MOVX    @DPTR,A
    136              HalKeyConfig( OnboardKeyIntEnable, OnBoard_KeyCallback);
   \   000020                ; Setup parameters for call to function HalKeyConfig
   \   000020   7A..         MOV     R2,#(??OnBoard_KeyCallback?relay & 0xff)
   \   000022   7B..         MOV     R3,#((??OnBoard_KeyCallback?relay >> 8) & 0xff)
   \   000024   F9           MOV     R1,A
   \   000025   12....       LCALL   ??HalKeyConfig?relay
    137            }
    138          }
   \                     ??InitBoard_1:
   \   000028   D083         POP     DPH
   \   00002A   D082         POP     DPL
   \   00002C   02....       LJMP    ?BRET
    139          
    140          /*********************************************************************
    141           * @fn      ChkReset()
    142           * @brief   Check reset bits - if reset cause is unknown, assume a
    143           *          brown-out (low power), assume batteries are not reliable,
    144           *          hang in a loop and sequence through the LEDs.
    145           * @param   None
    146           * @return  None
    147           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    148          void ChkReset( void )
   \                     ChkReset:
    149          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    150            uint8 led;
    151            uint8 rib;
    152          
    153            // Isolate reset indicator bits
    154            rib = SLEEPSTA & LRESET;
   \   000005   7418         MOV     A,#0x18
   \   000007   559D         ANL     A,0x9d
   \   000009   FA           MOV     R2,A
    155          
    156            if ( rib == RESETPO )
   \   00000A   6040         JZ      ??ChkReset_0
    157            {
    158              // Put code here to handle Power-On reset
    159            }
    160            else if ( rib == RESETEX )
   \   00000C   7408         MOV     A,#0x8
   \   00000E   6A           XRL     A,R2
   \   00000F   603B         JZ      ??ChkReset_0
    161            {
    162              // Put code here to handle External reset
    163            }
    164            else if ( rib == RESETWD )
   \   000011   7410         MOV     A,#0x10
   \   000013   6A           XRL     A,R2
   \   000014   6036         JZ      ??ChkReset_0
    165            {
    166              // Put code here to handle WatchDog reset
    167            }
    168            else
    169            {
    170              // Unknown, hang and blink
    171              HAL_DISABLE_INTERRUPTS();
   \   000016   C2AF         CLR     0xa8.7
    172              led = HAL_LED_4;
   \                     ??ChkReset_1:
   \   000018   7E08         MOV     R6,#0x8
    173              while ( 1 ) {
    174                HalLedSet( led, HAL_LED_MODE_ON );
   \                     ??ChkReset_2:
   \   00001A                ; Setup parameters for call to function HalLedSet
   \   00001A   7A01         MOV     R2,#0x1
   \   00001C   EE           MOV     A,R6
   \   00001D   F9           MOV     R1,A
   \   00001E   12....       LCALL   ??HalLedSet?relay
    175                MicroWait( 62500 );
   \   000021                ; Setup parameters for call to function Onboard_wait
   \   000021   7A24         MOV     R2,#0x24
   \   000023   7BF4         MOV     R3,#-0xc
   \   000025   12....       LCALL   ??Onboard_wait?relay
    176                MicroWait( 62500 );
   \   000028                ; Setup parameters for call to function Onboard_wait
   \   000028   7A24         MOV     R2,#0x24
   \   00002A   7BF4         MOV     R3,#-0xc
   \   00002C   12....       LCALL   ??Onboard_wait?relay
    177                HalLedSet( led, HAL_LED_MODE_OFF );
   \   00002F                ; Setup parameters for call to function HalLedSet
   \   00002F   7A00         MOV     R2,#0x0
   \   000031   EE           MOV     A,R6
   \   000032   F9           MOV     R1,A
   \   000033   12....       LCALL   ??HalLedSet?relay
    178                MicroWait( 37500 );
   \   000036                ; Setup parameters for call to function Onboard_wait
   \   000036   7A7C         MOV     R2,#0x7c
   \   000038   7B92         MOV     R3,#-0x6e
   \   00003A   12....       LCALL   ??Onboard_wait?relay
    179                MicroWait( 37500 );
   \   00003D                ; Setup parameters for call to function Onboard_wait
   \   00003D   7A7C         MOV     R2,#0x7c
   \   00003F   7B92         MOV     R3,#-0x6e
   \   000041   12....       LCALL   ??Onboard_wait?relay
    180                if ( !(led >>= 1) )
   \   000044   EE           MOV     A,R6
   \   000045   C3           CLR     C
   \   000046   13           RRC     A
   \   000047   FE           MOV     R6,A
   \   000048   70D0         JNZ     ??ChkReset_2
    181                  led = HAL_LED_4;
   \   00004A   80CC         SJMP    ??ChkReset_1
    182              }
    183            }
    184          }
   \                     ??ChkReset_0:
   \   00004C   7F01         MOV     R7,#0x1
   \   00004E   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000051                REQUIRE _A_IEN0
   \   000051                REQUIRE SLEEPSTA
    185          
    186          /*********************************************************************
    187           *                        "Keyboard" Support
    188           *********************************************************************/
    189          
    190          /*********************************************************************
    191           * Keyboard Register function
    192           *
    193           * The keyboard handler is setup to send all keyboard changes to
    194           * one task (if a task is registered).
    195           *
    196           * If a task registers, it will get all the keys. You can change this
    197           * to register for individual keys.
    198           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    199          uint8 RegisterForKeys( uint8 task_id )
   \                     RegisterForKeys:
    200          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    201            // Allow only the first task
    202            if ( registeredKeysTaskID == NO_TASK_ID )
   \   000004   90....       MOV     DPTR,#registeredKeysTaskID
   \   000007   E0           MOVX    A,@DPTR
   \   000008   64FF         XRL     A,#0xff
   \   00000A   7006         JNZ     ??RegisterForKeys_0
    203            {
    204              registeredKeysTaskID = task_id;
   \   00000C   E9           MOV     A,R1
   \   00000D   F0           MOVX    @DPTR,A
    205              return ( true );
   \   00000E   7901         MOV     R1,#0x1
   \   000010   8002         SJMP    ??RegisterForKeys_1
    206            }
    207            else
    208              return ( false );
   \                     ??RegisterForKeys_0:
   \   000012   7900         MOV     R1,#0x0
   \                     ??RegisterForKeys_1:
   \   000014   D083         POP     DPH
   \   000016   D082         POP     DPL
   \   000018   02....       LJMP    ?BRET
    209          }
    210          
    211          /*********************************************************************
    212           * @fn      OnBoard_SendKeys
    213           *
    214           * @brief   Send "Key Pressed" message to application.
    215           *
    216           * @param   keys  - keys that were pressed
    217           *          state - shifted
    218           *
    219           * @return  status
    220           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    221          uint8 OnBoard_SendKeys( uint8 keys, uint8 state )
   \                     OnBoard_SendKeys:
    222          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   FF           MOV     R7,A
    223            keyChange_t *msgPtr;
    224          
    225            if ( registeredKeysTaskID != NO_TASK_ID )
   \   000009   90....       MOV     DPTR,#registeredKeysTaskID
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   64FF         XRL     A,#0xff
   \   00000F   602D         JZ      ??OnBoard_SendKeys_0
    226            {
    227              // Send the address to the task
    228              msgPtr = (keyChange_t *)osal_msg_allocate( sizeof(keyChange_t) );
   \   000011                ; Setup parameters for call to function osal_msg_allocate
   \   000011   7A04         MOV     R2,#0x4
   \   000013   7B00         MOV     R3,#0x0
   \   000015   12....       LCALL   ??osal_msg_allocate?relay
    229              if ( msgPtr )
   \   000018   EA           MOV     A,R2
   \   000019   7001         JNZ     ??OnBoard_SendKeys_1
   \   00001B   EB           MOV     A,R3
   \                     ??OnBoard_SendKeys_1:
   \   00001C   601C         JZ      ??OnBoard_SendKeys_2
    230              {
    231                msgPtr->hdr.event = KEY_CHANGE;
   \   00001E   74C0         MOV     A,#-0x40
   \   000020   8A82         MOV     DPL,R2
   \   000022   8B83         MOV     DPH,R3
   \   000024   F0           MOVX    @DPTR,A
    232                msgPtr->state = state;
   \   000025   EF           MOV     A,R7
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   F0           MOVX    @DPTR,A
    233                msgPtr->keys = keys;
   \   000029   EE           MOV     A,R6
   \   00002A   8A82         MOV     DPL,R2
   \   00002C   8B83         MOV     DPH,R3
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   F0           MOVX    @DPTR,A
    234          
    235                osal_msg_send( registeredKeysTaskID, (uint8 *)msgPtr );
   \   000032                ; Setup parameters for call to function osal_msg_send
   \   000032   90....       MOV     DPTR,#registeredKeysTaskID
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F9           MOV     R1,A
   \   000037   12....       LCALL   ??osal_msg_send?relay
    236              }
    237              return ( ZSuccess );
   \                     ??OnBoard_SendKeys_2:
   \   00003A   7900         MOV     R1,#0x0
   \   00003C   8002         SJMP    ??OnBoard_SendKeys_3
    238            }
    239            else
    240              return ( ZFailure );
   \                     ??OnBoard_SendKeys_0:
   \   00003E   7901         MOV     R1,#0x1
   \                     ??OnBoard_SendKeys_3:
   \   000040   7F02         MOV     R7,#0x2
   \   000042   02....       LJMP    ?BANKED_LEAVE_XDATA
    241          }
    242          
    243          /*********************************************************************
    244           * @fn      OnBoard_KeyCallback
    245           *
    246           * @brief   Callback service for keys
    247           *
    248           * @param   keys  - keys that were pressed
    249           *          state - shifted
    250           *
    251           * @return  void
    252           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    253          void OnBoard_KeyCallback ( uint8 keys, uint8 state )
   \                     OnBoard_KeyCallback:
    254          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    255            uint8 shift;
    256            (void)state;
    257          
    258            // shift key (S1) is used to generate key interrupt
    259            // applications should not use S1 when key interrupt is enabled
    260            shift = (OnboardKeyIntEnable == HAL_KEY_INTERRUPT_ENABLE) ? false : ((keys & HAL_KEY_SW_6) ? true : false);
   \   000004   90....       MOV     DPTR,#OnboardKeyIntEnable
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   7004         JNZ     ??OnBoard_KeyCallback_0
   \   00000C   7A00         MOV     R2,#0x0
   \   00000E   8011         SJMP    ??OnBoard_KeyCallback_1
   \                     ??OnBoard_KeyCallback_0:
   \   000010   E9           MOV     A,R1
   \   000011   A2E5         MOV     C,0xE0 /* A   */.5
   \   000013   5004         JNC     ??OnBoard_KeyCallback_2
   \   000015   D2F0         SETB    B.0
   \   000017   8002         SJMP    ??OnBoard_KeyCallback_3
   \                     ??OnBoard_KeyCallback_2:
   \   000019   C2F0         CLR     B.0
   \                     ??OnBoard_KeyCallback_3:
   \   00001B   A2F0         MOV     C,B.0
   \   00001D   E4           CLR     A
   \   00001E   92E0         MOV     0xE0 /* A   */.0,C
   \   000020   FA           MOV     R2,A
    261          
    262            if ( OnBoard_SendKeys( keys, shift ) != ZSuccess )
   \                     ??OnBoard_KeyCallback_1:
   \   000021                ; Setup parameters for call to function OnBoard_SendKeys
   \   000021   12....       LCALL   ??OnBoard_SendKeys?relay
    263            {
    264              // Process SW1 here
    265              if ( keys & HAL_KEY_SW_1 )  // Switch 1
    266              {
    267              }
    268              // Process SW2 here
    269              if ( keys & HAL_KEY_SW_2 )  // Switch 2
    270              {
    271              }
    272              // Process SW3 here
    273              if ( keys & HAL_KEY_SW_3 )  // Switch 3
    274              {
    275              }
    276              // Process SW4 here
    277              if ( keys & HAL_KEY_SW_4 )  // Switch 4
    278              {
    279              }
    280              // Process SW5 here
    281              if ( keys & HAL_KEY_SW_5 )  // Switch 5
    282              {
    283              }
    284              // Process SW6 here
    285              if ( keys & HAL_KEY_SW_6 )  // Switch 6
    286              {
    287              }
    288            }
    289          }
   \   000024   D083         POP     DPH
   \   000026   D082         POP     DPL
   \   000028   02....       LJMP    ?BRET
    290          
    291          /*********************************************************************
    292           * @fn      OnBoard_stack_used
    293           *
    294           * @brief   Runs through the stack looking for touched memory.
    295           *
    296           * @param   none
    297           *
    298           * @return  Maximum number of bytes used by the stack.
    299           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    300          uint16 OnBoard_stack_used(void)
   \                     OnBoard_stack_used:
    301          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    302            uint8 const *ptr;
    303            uint8 cnt = 0;
   \   000004   7A00         MOV     R2,#0x0
    304          
    305            for (ptr = XSTACK_END; ptr > XSTACK_BEG; ptr--)
   \   000006   7582..       MOV     DPL,#((SFE(XSTACK) + 255) & 0xff)
   \   000009   7583..       MOV     DPH,#(((SFE(XSTACK) - 1) >> 8) & 0xff)
   \   00000C   800E         SJMP    ??OnBoard_stack_used_0
    306            {
    307              if (STACK_INIT_VALUE == *ptr)
    308              {
    309                if (++cnt >= MIN_RAM_INIT)
    310                {
    311                  ptr += MIN_RAM_INIT;
    312                  break;
    313                }
    314              }
    315              else
    316              {
    317                cnt = 0;
   \                     ??OnBoard_stack_used_1:
   \   00000E   7A00         MOV     R2,#0x0
    318              }
   \                     ??OnBoard_stack_used_2:
   \   000010   E582         MOV     A,DPL
   \   000012   24FF         ADD     A,#-0x1
   \   000014   F582         MOV     DPL,A
   \   000016   E583         MOV     A,DPH
   \   000018   34FF         ADDC    A,#-0x1
   \   00001A   F583         MOV     DPH,A
   \                     ??OnBoard_stack_used_0:
   \   00001C   C3           CLR     C
   \   00001D   74..         MOV     A,#(SFB(XSTACK) & 0xff)
   \   00001F   9582         SUBB    A,DPL
   \   000021   74..         MOV     A,#((SFB(XSTACK) >> 8) & 0xff)
   \   000023   9583         SUBB    A,DPH
   \   000025   5018         JNC     ??OnBoard_stack_used_3
   \   000027   E0           MOVX    A,@DPTR
   \   000028   64CD         XRL     A,#0xcd
   \   00002A   70E2         JNZ     ??OnBoard_stack_used_1
   \   00002C   0A           INC     R2
   \   00002D   EA           MOV     A,R2
   \   00002E   C3           CLR     C
   \   00002F   940C         SUBB    A,#0xc
   \   000031   40DD         JC      ??OnBoard_stack_used_2
   \   000033   E582         MOV     A,DPL
   \   000035   240C         ADD     A,#0xc
   \   000037   F582         MOV     DPL,A
   \   000039   E583         MOV     A,DPH
   \   00003B   3400         ADDC    A,#0x0
   \   00003D   F583         MOV     DPH,A
    319            }
    320          
    321            return (uint16)(XSTACK_END - ptr + 1);
   \                     ??OnBoard_stack_used_3:
   \   00003F   74..         MOV     A,#((SFE(XSTACK) + 255) & 0xff)
   \   000041   C3           CLR     C
   \   000042   9582         SUBB    A,DPL
   \   000044   F8           MOV     R0,A
   \   000045   74..         MOV     A,#(((SFE(XSTACK) - 1) >> 8) & 0xff)
   \   000047   9583         SUBB    A,DPH
   \   000049   F9           MOV     R1,A
   \   00004A   7401         MOV     A,#0x1
   \   00004C   28           ADD     A,R0
   \   00004D   FA           MOV     R2,A
   \   00004E   E4           CLR     A
   \   00004F   39           ADDC    A,R1
   \   000050   FB           MOV     R3,A
   \   000051   D083         POP     DPH
   \   000053   D082         POP     DPL
   \   000055   02....       LJMP    ?BRET
    322          }
    323          
    324          /*********************************************************************
    325           * @fn      _itoa
    326           *
    327           * @brief   convert a 16bit number to ASCII
    328           *
    329           * @param   num -
    330           *          buf -
    331           *          radix -
    332           *
    333           * @return  void
    334           *
    335           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    336          void _itoa(uint16 num, uint8 *buf, uint8 radix)
   \                     _itoa:
    337          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   \   00000E   8C..         MOV     ?V0 + 0,R4
   \   000010   8D..         MOV     ?V0 + 1,R5
   \   000012   89..         MOV     ?V0 + 5,R1
    338            char c,i;
    339            uint8 *p, rst[5];
    340          
    341            p = rst;
   \   000014   85..82       MOV     DPL,?XSP + 0
   \   000017   85..83       MOV     DPH,?XSP + 1
   \   00001A   AC82         MOV     R4,DPL
   \   00001C   AD83         MOV     R5,DPH
    342            for ( i=0; i<5; i++,p++ )
   \   00001E   75..00       MOV     ?V0 + 4,#0x0
   \   000021   8007         SJMP    ??_itoa_0
   \                     ??_itoa_1:
   \   000023   05..         INC     ?V0 + 4
   \   000025   A3           INC     DPTR
   \   000026   AC82         MOV     R4,DPL
   \   000028   AD83         MOV     R5,DPH
   \                     ??_itoa_0:
   \   00002A   E5..         MOV     A,?V0 + 4
   \   00002C   C3           CLR     C
   \   00002D   9405         SUBB    A,#0x5
   \   00002F   503C         JNC     ??_itoa_2
    343            {
    344              c = num % radix;  // Isolate a digit
   \   000031   85..82       MOV     DPL,?V0 + 5
   \   000034   8582..       MOV     ?V0 + 2,DPL
   \   000037   EE           MOV     A,R6
   \   000038   F8           MOV     R0,A
   \   000039   EF           MOV     A,R7
   \   00003A   F9           MOV     R1,A
   \   00003B   AA..         MOV     R2,?V0 + 2
   \   00003D   7B00         MOV     R3,#0x0
   \   00003F   12....       LCALL   ?US_DIV_MOD
   \   000042   EA           MOV     A,R2
    345              *p = c + (( c < 10 ) ? '0' : '7');  // Convert to Ascii
   \   000043   940A         SUBB    A,#0xa
   \   000045   5004         JNC     ??_itoa_3
   \   000047   7830         MOV     R0,#0x30
   \   000049   8002         SJMP    ??_itoa_4
   \                     ??_itoa_3:
   \   00004B   7837         MOV     R0,#0x37
   \                     ??_itoa_4:
   \   00004D   E8           MOV     A,R0
   \   00004E   2A           ADD     A,R2
   \   00004F   8C82         MOV     DPL,R4
   \   000051   8D83         MOV     DPH,R5
   \   000053   F0           MOVX    @DPTR,A
    346              num /= radix;
   \   000054   EE           MOV     A,R6
   \   000055   F8           MOV     R0,A
   \   000056   EF           MOV     A,R7
   \   000057   F9           MOV     R1,A
   \   000058   AA..         MOV     R2,?V0 + 2
   \   00005A   7B00         MOV     R3,#0x0
   \   00005C   12....       LCALL   ?US_DIV_MOD
   \   00005F   88..         MOV     ?V0 + 2,R0
   \   000061   89..         MOV     ?V0 + 3,R1
   \   000063   AE..         MOV     R6,?V0 + 2
   \   000065   AF..         MOV     R7,?V0 + 3
    347              if ( !num )
   \   000067   EE           MOV     A,R6
   \   000068   7001         JNZ     ??_itoa_5
   \   00006A   EF           MOV     A,R7
   \                     ??_itoa_5:
   \   00006B   70B6         JNZ     ??_itoa_1
    348                break;
    349            }
    350          
    351            for ( c=0 ; c<=i; c++ )
   \                     ??_itoa_2:
   \   00006D   7A00         MOV     R2,#0x0
   \   00006F   801C         SJMP    ??_itoa_6
    352              *buf++ = *p--;  // Reverse character order
   \                     ??_itoa_7:
   \   000071   8C82         MOV     DPL,R4
   \   000073   8D83         MOV     DPH,R5
   \   000075   E0           MOVX    A,@DPTR
   \   000076   85..82       MOV     DPL,?V0 + 0
   \   000079   85..83       MOV     DPH,?V0 + 1
   \   00007C   F0           MOVX    @DPTR,A
   \   00007D   EC           MOV     A,R4
   \   00007E   24FF         ADD     A,#-0x1
   \   000080   1C           DEC     R4
   \   000081   ED           MOV     A,R5
   \   000082   34FF         ADDC    A,#-0x1
   \   000084   FD           MOV     R5,A
   \   000085   A3           INC     DPTR
   \   000086   8582..       MOV     ?V0 + 0,DPL
   \   000089   8583..       MOV     ?V0 + 1,DPH
   \   00008C   0A           INC     R2
   \                     ??_itoa_6:
   \   00008D   E5..         MOV     A,?V0 + 4
   \   00008F   C3           CLR     C
   \   000090   9A           SUBB    A,R2
   \   000091   50DE         JNC     ??_itoa_7
    353          
    354            *buf = '\0';
   \   000093   E4           CLR     A
   \   000094   85..82       MOV     DPL,?V0 + 0
   \   000097   85..83       MOV     DPH,?V0 + 1
   \   00009A   F0           MOVX    @DPTR,A
    355          }
   \   00009B   7405         MOV     A,#0x5
   \   00009D   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A0   7F06         MOV     R7,#0x6
   \   0000A2   02....       LJMP    ?BANKED_LEAVE_XDATA
    356          
    357          /*********************************************************************
    358           * @fn        Onboard_rand
    359           *
    360           * @brief    Random number generator
    361           *
    362           * @param   none
    363           *
    364           * @return  uint16 - new random number
    365           *
    366           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    367          uint16 Onboard_rand( void )
   \                     Onboard_rand:
    368          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    369            return ( MAC_RADIO_RANDOM_WORD() );
   \   000004                ; Setup parameters for call to function macMcuRandomWord
   \   000004   12....       LCALL   ??macMcuRandomWord?relay
   \   000007   D083         POP     DPH
   \   000009   D082         POP     DPL
   \   00000B   02....       LJMP    ?BRET
    370          }
    371          
    372          /*********************************************************************
    373           * @fn        Onboard_wait
    374           *
    375           * @brief    Delay wait
    376           *
    377           * @param   uint16 - time to wait
    378           *
    379           * @return  none
    380           *
    381           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    382          void Onboard_wait( uint16 timeout )
   \                     Onboard_wait:
    383          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   8003         SJMP    ??Onboard_wait_0
    384            while (timeout--)
    385            {
    386              asm("NOP");
   \                     ??Onboard_wait_1:
   \   000002   00           NOP
    387              asm("NOP");
   \   000003   00           NOP
    388              asm("NOP");
   \   000004   00           NOP
    389            }
   \                     ??Onboard_wait_0:
   \   000005   EA           MOV     A,R2
   \   000006   F8           MOV     R0,A
   \   000007   EB           MOV     A,R3
   \   000008   F9           MOV     R1,A
   \   000009   74FF         MOV     A,#-0x1
   \   00000B   28           ADD     A,R0
   \   00000C   1A           DEC     R2
   \   00000D   74FF         MOV     A,#-0x1
   \   00000F   39           ADDC    A,R1
   \   000010   FB           MOV     R3,A
   \   000011   E8           MOV     A,R0
   \   000012   7001         JNZ     ??Onboard_wait_2
   \   000014   E9           MOV     A,R1
   \                     ??Onboard_wait_2:
   \   000015   70EB         JNZ     ??Onboard_wait_1
    390          }
   \   000017   02....       LJMP    ?BRET
    391          
    392          /*********************************************************************
    393           *                    EXTERNAL I/O FUNCTIONS
    394           *
    395           * User defined functions to control external devices. Add your code
    396           * to the following functions to control devices wired to DB outputs.
    397           *
    398           *********************************************************************/
    399          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    400          void BigLight_On( void )
   \                     BigLight_On:
    401          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    402            // Put code here to turn on an external light
    403          }
   \   000000   02....       LJMP    ?BRET
    404          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    405          void BigLight_Off( void )
   \                     BigLight_Off:
    406          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    407            // Put code here to turn off an external light
    408          }
   \   000000   02....       LJMP    ?BRET
    409          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    410          void BuzzerControl( uint8 on )
   \                     BuzzerControl:
    411          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    412            // Put code here to turn a buzzer on/off
    413            (void)on;
    414          }
   \   000000   02....       LJMP    ?BRET
    415          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    416          void Dimmer( uint8 lvl )
   \                     Dimmer:
    417          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    418            // Put code here to control a dimmer
    419            (void)lvl;
    420          }
   \   000000   02....       LJMP    ?BRET
    421          
    422          // No dip switches on this board

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    423          uint8 GetUserDipSw( void )
   \                     GetUserDipSw:
    424          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    425            return 0;
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
    426          }

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for registeredKeysTaskID>`:
   \   000000   FF           DB 255

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??InitBoard?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    InitBoard

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ChkReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ChkReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??RegisterForKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    RegisterForKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??OnBoard_SendKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    OnBoard_SendKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??OnBoard_KeyCallback?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    OnBoard_KeyCallback

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??OnBoard_stack_used?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    OnBoard_stack_used

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??_itoa?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    _itoa

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Onboard_rand?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Onboard_rand

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Onboard_wait?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Onboard_wait

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??BigLight_On?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    BigLight_On

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??BigLight_Off?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    BigLight_Off

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??BuzzerControl?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    BuzzerControl

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Dimmer?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Dimmer

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??GetUserDipSw?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    GetUserDipSw
    427          
    428          /*********************************************************************
    429          *********************************************************************/

   Maximum stack usage in bytes:

     Function               ISTACK PSTACK XSTACK
     --------               ------ ------ ------
     BigLight_Off               0      0      0
     BigLight_On                0      0      0
     BuzzerControl              0      0      0
     ChkReset                   0      0      9
       -> HalLedSet             0      0     18
       -> Onboard_wait          0      0     18
       -> Onboard_wait          0      0     18
       -> HalLedSet             0      0     18
       -> Onboard_wait          0      0     18
       -> Onboard_wait          0      0     18
     Dimmer                     0      0      0
     GetUserDipSw               0      0      0
     InitBoard                  2      0      0
       -> osal_int_disable      4      0      0
       -> HalLedSet             4      0      0
       -> ChkReset              4      0      0
       -> MT_SysResetInd        4      0      0
       -> HalKeyConfig          4      0      0
     OnBoard_KeyCallback        2      0      0
       -> OnBoard_SendKeys      4      0      0
     OnBoard_SendKeys           1      0     10
       -> osal_msg_allocate     0      0     20
       -> osal_msg_send         0      0     20
     OnBoard_stack_used         2      0      0
     Onboard_rand               2      0      0
       -> macMcuRandomWord      4      0      0
     Onboard_wait               0      0      9
     RegisterForKeys            2      0      0
     _itoa                      1      0     19


   Segment part sizes:

     Function/Label                          Bytes
     --------------                          -----
     SLEEPSTA                                   1
     _A_IEN0                                    1
     OnboardKeyIntEnable                        1
     aExtendedAddress                           8
     registeredKeysTaskID                       1
     InitBoard                                 47
     ChkReset                                  81
     RegisterForKeys                           27
     OnBoard_SendKeys                          69
     OnBoard_KeyCallback                       43
     OnBoard_stack_used                        88
     _itoa                                    165
     Onboard_rand                              14
     Onboard_wait                              26
     BigLight_On                                3
     BigLight_Off                               3
     BuzzerControl                              3
     Dimmer                                     3
     GetUserDipSw                               5
     ?<Initializer for registeredKeysTaskID>    1
     ??InitBoard?relay                          6
     ??ChkReset?relay                           6
     ??RegisterForKeys?relay                    6
     ??OnBoard_SendKeys?relay                   6
     ??OnBoard_KeyCallback?relay                6
     ??OnBoard_stack_used?relay                 6
     ??_itoa?relay                              6
     ??Onboard_rand?relay                       6
     ??Onboard_wait?relay                       6
     ??BigLight_On?relay                        6
     ??BigLight_Off?relay                       6
     ??BuzzerControl?relay                      6
     ??Dimmer?relay                             6
     ??GetUserDipSw?relay                       6

 
 577 bytes in segment BANKED_CODE
  84 bytes in segment BANK_RELAYS
   2 bytes in segment SFR_AN
   1 byte  in segment XDATA_I
   1 byte  in segment XDATA_ID
   9 bytes in segment XDATA_Z
 
 662 bytes of CODE  memory
   0 bytes of DATA  memory (+ 2 bytes shared)
  10 bytes of XDATA memory

Errors: none
Warnings: none
